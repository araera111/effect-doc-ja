<!doctype html>
<html
  lang="en"
  dir="ltr"
  data-has-toc
  data-has-sidebar
  data-theme="dark"
  class="astro-ds2wt7hw"
>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Batching | Effect日本語版ドキュメント</title>
    <link rel="canonical" />
    <link rel="shortcut icon" href="/icon.png" type="image/png" />
    <meta name="generator" content="Astro v4.14.5" />
    <meta name="generator" content="Starlight v0.26.1" />
    <meta property="og:title" content="Batching" />
    <meta property="og:type" content="article" />
    <meta property="og:url" />
    <meta property="og:locale" content="en" />
    <meta property="og:description" />
    <meta property="og:site_name" content="Effect日本語版ドキュメント" />
    <meta name="twitter:card" content="summary_large_image" />
    <script>
      window.StarlightThemeProvider = (() => {
        const storedTheme =
          typeof localStorage !== "undefined" &&
          localStorage.getItem("starlight-theme");
        const theme =
          storedTheme ||
          (window.matchMedia("(prefers-color-scheme: light)").matches
            ? "light"
            : "dark");
        document.documentElement.dataset.theme =
          theme === "light" ? "light" : "dark";
        return {
          updatePickers(theme = storedTheme || "auto") {
            document
              .querySelectorAll("starlight-theme-select")
              .forEach((picker) => {
                const select = picker.querySelector("select");
                if (select) select.value = theme;
                /** @type {HTMLTemplateElement | null} */
                const tmpl = document.querySelector(`#theme-icons`);
                const newIcon = tmpl && tmpl.content.querySelector("." + theme);
                if (newIcon) {
                  const oldIcon = picker.querySelector("svg.label-icon");
                  if (oldIcon) {
                    oldIcon.replaceChildren(
                      ...newIcon.cloneNode(true).childNodes,
                    );
                  }
                }
              });
          },
        };
      })();
    </script>
    <template id="theme-icons"
      ><svg
        aria-hidden="true"
        class="light astro-mzbodlcp"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="currentColor"
        style="--sl-icon-size: 1em"
      >
        <path
          d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"
        />
      </svg>
      <svg
        aria-hidden="true"
        class="dark astro-mzbodlcp"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="currentColor"
        style="--sl-icon-size: 1em"
      >
        <path
          d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"
        />
      </svg>
      <svg
        aria-hidden="true"
        class="auto astro-mzbodlcp"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="currentColor"
        style="--sl-icon-size: 1em"
      >
        <path
          d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"
        />
      </svg>
    </template>
    <link rel="stylesheet" href="/_astro/index.C-KpjUOJ.css" />
    <style>
      :root {
        --sl-badge-default-border: var(--sl-color-accent);
        --sl-badge-default-bg: var(--sl-color-accent-low);
        --sl-badge-default-text: #fff;
        --sl-badge-note-border: var(--sl-color-blue);
        --sl-badge-note-bg: var(--sl-color-blue-low);
        --sl-badge-note-text: #fff;
        --sl-badge-danger-border: var(--sl-color-red);
        --sl-badge-danger-bg: var(--sl-color-red-low);
        --sl-badge-danger-text: #fff;
        --sl-badge-success-border: var(--sl-color-green);
        --sl-badge-success-bg: var(--sl-color-green-low);
        --sl-badge-success-text: #fff;
        --sl-badge-caution-border: var(--sl-color-orange);
        --sl-badge-caution-bg: var(--sl-color-orange-low);
        --sl-badge-caution-text: #fff;
        --sl-badge-tip-border: var(--sl-color-purple);
        --sl-badge-tip-bg: var(--sl-color-purple-low);
        --sl-badge-tip-text: #fff;
      }
      [data-theme="light"]:root {
        --sl-badge-default-bg: var(--sl-color-accent-high);
        --sl-badge-note-bg: var(--sl-color-blue-high);
        --sl-badge-danger-bg: var(--sl-color-red-high);
        --sl-badge-success-bg: var(--sl-color-green-high);
        --sl-badge-caution-bg: var(--sl-color-orange-high);
        --sl-badge-tip-bg: var(--sl-color-purple-high);
      }
      .sl-badge:where(.astro-x444flib) {
        display: inline-block;
        border: 1px solid var(--sl-color-border-badge);
        border-radius: 0.25rem;
        font-family: var(--sl-font-system-mono);
        line-height: normal;
        color: var(--sl-color-text-badge);
        background-color: var(--sl-color-bg-badge);
        overflow-wrap: anywhere;
      }
      .sidebar-content .sl-badge:where(.astro-x444flib) {
        line-height: 1;
        font-size: var(--sl-text-xs);
        padding: 0.125rem 0.375rem;
      }
      .sidebar-content
        a[aria-current="page"]
        > .sl-badge:where(.astro-x444flib) {
        --sl-color-bg-badge: transparent;
        --sl-color-border-badge: currentColor;
        color: inherit;
      }
      .default:where(.astro-x444flib) {
        --sl-color-bg-badge: var(--sl-badge-default-bg);
        --sl-color-border-badge: var(--sl-badge-default-border);
        --sl-color-text-badge: var(--sl-badge-default-text);
      }
      .note:where(.astro-x444flib) {
        --sl-color-bg-badge: var(--sl-badge-note-bg);
        --sl-color-border-badge: var(--sl-badge-note-border);
        --sl-color-text-badge: var(--sl-badge-note-text);
      }
      .danger:where(.astro-x444flib) {
        --sl-color-bg-badge: var(--sl-badge-danger-bg);
        --sl-color-border-badge: var(--sl-badge-danger-border);
        --sl-color-text-badge: var(--sl-badge-danger-text);
      }
      .success:where(.astro-x444flib) {
        --sl-color-bg-badge: var(--sl-badge-success-bg);
        --sl-color-border-badge: var(--sl-badge-success-border);
        --sl-color-text-badge: var(--sl-badge-success-text);
      }
      .tip:where(.astro-x444flib) {
        --sl-color-bg-badge: var(--sl-badge-tip-bg);
        --sl-color-border-badge: var(--sl-badge-tip-border);
        --sl-color-text-badge: var(--sl-badge-tip-text);
      }
      .caution:where(.astro-x444flib) {
        --sl-color-bg-badge: var(--sl-badge-caution-bg);
        --sl-color-border-badge: var(--sl-badge-caution-border);
        --sl-color-text-badge: var(--sl-badge-caution-text);
      }
      .small:where(.astro-x444flib) {
        font-size: var(--sl-text-xs);
        padding: 0.125rem 0.25rem;
      }
      .medium:where(.astro-x444flib) {
        font-size: var(--sl-text-sm);
        padding: 0.175rem 0.35rem;
      }
      .large:where(.astro-x444flib) {
        font-size: var(--sl-text-base);
        padding: 0.225rem 0.45rem;
      }
      .sl-markdown-content
        :is(h1, h2, h3, h4, h5, h6)
        .sl-badge:where(.astro-x444flib) {
        vertical-align: middle;
      }
      svg:where(.astro-mzbodlcp) {
        color: var(--sl-icon-color);
        font-size: var(--sl-icon-size, 1em);
        width: 1em;
        height: 1em;
      }
      starlight-tabs:where(.astro-oy26qiqb) {
        display: block;
      }
      .tablist-wrapper:where(.astro-oy26qiqb) {
        overflow-x: auto;
      }
      :where(.astro-oy26qiqb)[role="tablist"] {
        display: flex;
        list-style: none;
        border-bottom: 2px solid var(--sl-color-gray-5);
        padding: 0;
      }
      .tab:where(.astro-oy26qiqb) {
        margin-bottom: -2px;
      }
      .tab:where(.astro-oy26qiqb) > :where(.astro-oy26qiqb)[role="tab"] {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0 1.25rem;
        text-decoration: none;
        border-bottom: 2px solid var(--sl-color-gray-5);
        color: var(--sl-color-gray-3);
        outline-offset: var(--sl-outline-offset-inside);
        overflow-wrap: initial;
      }
      .tab:where(.astro-oy26qiqb)
        :where(.astro-oy26qiqb)[role="tab"][aria-selected="true"] {
        color: var(--sl-color-white);
        border-color: var(--sl-color-text-accent);
        font-weight: 600;
      }
      .tablist-wrapper:where(.astro-oy26qiqb) ~ [role="tabpanel"] {
        margin-top: 1rem;
      }
      .sl-steps {
        --bullet-size: calc(var(--sl-line-height) * 1rem);
        --bullet-margin: 0.375rem;
        list-style: none;
        counter-reset: steps-counter var(--sl-steps-start, 0);
        padding-inline-start: 0;
      }
      .sl-steps > li {
        counter-increment: steps-counter;
        position: relative;
        padding-inline-start: calc(var(--bullet-size) + 1rem);
        padding-bottom: 1px;
        min-height: calc(var(--bullet-size) + var(--bullet-margin));
      }
      .sl-steps > li + li {
        margin-top: 0;
      }
      .sl-steps > li:before {
        content: counter(steps-counter);
        position: absolute;
        top: 0;
        inset-inline-start: 0;
        width: var(--bullet-size);
        height: var(--bullet-size);
        line-height: var(--bullet-size);
        font-size: var(--sl-text-xs);
        font-weight: 600;
        text-align: center;
        color: var(--sl-color-white);
        background-color: var(--sl-color-gray-6);
        border-radius: 99rem;
        box-shadow: inset 0 0 0 1px var(--sl-color-gray-5);
      }
      .sl-steps > li:after {
        --guide-width: 1px;
        content: "";
        position: absolute;
        top: calc(var(--bullet-size) + var(--bullet-margin));
        bottom: var(--bullet-margin);
        inset-inline-start: calc((var(--bullet-size) - var(--guide-width)) / 2);
        width: var(--guide-width);
        background-color: var(--sl-color-hairline-light);
      }
      .sl-steps > li > :first-child {
        --lh: calc(1em * var(--sl-line-height));
        --shift-y: calc(0.5 * (var(--bullet-size) - var(--lh)));
        transform: translateY(var(--shift-y));
        margin-bottom: var(--shift-y);
      }
      .sl-steps > li > :first-child:where(h1, h2, h3, h4, h5, h6) {
        --lh: calc(1em * var(--sl-line-height-headings));
      }
      @supports (--prop: 1lh) {
        .sl-steps > li > :first-child {
          --lh: 1lh;
        }
      }
      .sl-link-button:where(.astro-6gpctszv) {
        align-items: center;
        border: 1px solid transparent;
        border-radius: 999rem;
        display: inline-flex;
        font-size: var(--sl-text-sm);
        gap: 0.5em;
        line-height: 1.1875;
        outline-offset: 0.25rem;
        padding: 0.4375rem 1.125rem;
        text-decoration: none;
      }
      .sl-link-button:where(.astro-6gpctszv).primary {
        background: var(--sl-color-text-accent);
        border-color: var(--sl-color-text-accent);
        color: var(--sl-color-black);
      }
      .sl-link-button:where(.astro-6gpctszv).primary:hover {
        color: var(--sl-color-black);
      }
      .sl-link-button:where(.astro-6gpctszv).secondary {
        border-color: inherit;
        color: var(--sl-color-white);
      }
      .sl-link-button:where(.astro-6gpctszv).minimal {
        color: var(--sl-color-white);
        padding-inline: 0;
      }
      .sl-link-button:where(.astro-6gpctszv) svg {
        flex-shrink: 0;
      }
      @media (min-width: 50rem) {
        .sl-link-button:where(.astro-6gpctszv) {
          font-size: var(--sl-text-base);
          padding: 0.9375rem 1.25rem;
        }
      }
      .sl-markdown-content .sl-link-button:where(.astro-6gpctszv) {
        margin-inline-end: 1rem;
      }
      .sl-markdown-content
        .sl-link-button:where(.astro-6gpctszv):not(:where(p *)) {
        margin-block: 1rem;
      }
    </style>
    <script type="module" src="/_astro/hoisted.FicniJ2Z.js"></script>
    <script type="module" src="/_astro/page.LS5KDvwX.js"></script>
  </head>
  <body class="astro-ds2wt7hw">
    <a href="#_top" class="astro-4zievzub">Skip to content</a>
    <div class="page sl-flex astro-444rl2wv">
      <header class="header astro-444rl2wv">
        <div class="header sl-flex astro-y4sn2rzm">
          <div class="title-wrapper sl-flex astro-y4sn2rzm">
            <a href="/" class="site-title sl-flex astro-674d5lyb">
              <span class="astro-674d5lyb"> Effect日本語版ドキュメント </span>
            </a>
          </div>
          <div class="sl-flex astro-y4sn2rzm">
            <site-search
              data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}"
              class="astro-vplcdv4k"
            >
              <button
                data-open-modal
                disabled
                aria-label="Search"
                aria-keyshortcuts="Control+K"
                class="astro-vplcdv4k"
              >
                <svg
                  aria-hidden="true"
                  class="astro-vplcdv4k astro-mzbodlcp"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  style="--sl-icon-size: 1em"
                >
                  <path
                    d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"
                  />
                </svg>
                <span
                  class="sl-hidden md:sl-block astro-vplcdv4k"
                  aria-hidden="true"
                  >Search</span
                >
                <kbd
                  class="sl-hidden md:sl-flex astro-vplcdv4k"
                  style="display: none"
                >
                  <kbd class="astro-vplcdv4k">Ctrl</kbd
                  ><kbd class="astro-vplcdv4k">K</kbd>
                </kbd>
              </button>
              <dialog
                style="padding: 0"
                aria-label="Search"
                class="astro-vplcdv4k"
              >
                <div class="dialog-frame sl-flex astro-vplcdv4k">
                  <button
                    data-close-modal
                    class="sl-flex md:sl-hidden astro-vplcdv4k"
                  >
                    Cancel
                  </button>
                  <div class="search-container astro-vplcdv4k">
                    <div id="starlight__search" class="astro-vplcdv4k"></div>
                  </div>
                </div>
              </dialog>
            </site-search>
            <script>
              (() => {
                const openBtn = document.querySelector(
                  "button[data-open-modal]",
                );
                const shortcut = openBtn?.querySelector("kbd");
                if (!openBtn || !(shortcut instanceof HTMLElement)) return;
                const platformKey = shortcut.querySelector("kbd");
                if (
                  platformKey &&
                  /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)
                ) {
                  platformKey.textContent = "⌘";
                  openBtn.setAttribute("aria-keyshortcuts", "Meta+K");
                }
                shortcut.style.display = "";
              })();
            </script>
          </div>
          <div class="sl-hidden md:sl-flex right-group astro-y4sn2rzm">
            <div class="sl-flex social-icons astro-y4sn2rzm">
              <a
                href="https://github.com/withastro/starlight"
                rel="me"
                class="sl-flex astro-a5kxgq6d"
                ><span class="sr-only astro-a5kxgq6d">GitHub</span
                ><svg
                  aria-hidden="true"
                  class="astro-a5kxgq6d astro-mzbodlcp"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  style="--sl-icon-size: 1em"
                >
                  <path
                    d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"
                  />
                </svg>
              </a>
            </div>
            <starlight-theme-select>
              <label style="--sl-select-width: 6.25em" class="astro-6mzzj2bg">
                <span class="sr-only astro-6mzzj2bg">Select theme</span>
                <svg
                  aria-hidden="true"
                  class="icon label-icon astro-6mzzj2bg astro-mzbodlcp"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  style="--sl-icon-size: 1em"
                >
                  <path
                    d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"
                  />
                </svg>
                <select value="auto" class="astro-6mzzj2bg">
                  <option value="dark" class="astro-6mzzj2bg">Dark</option>
                  <option value="light" class="astro-6mzzj2bg">Light</option>
                  <option value="auto" selected="true" class="astro-6mzzj2bg">
                    Auto
                  </option>
                </select>
                <svg
                  aria-hidden="true"
                  class="icon caret astro-6mzzj2bg astro-mzbodlcp"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  style="--sl-icon-size: 1em"
                >
                  <path
                    d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"
                  />
                </svg>
              </label>
            </starlight-theme-select>
            <script>
              StarlightThemeProvider.updatePickers();
            </script>
          </div>
        </div>
      </header>
      <nav class="sidebar astro-444rl2wv" aria-label="Main">
        <starlight-menu-button class="astro-tzz67r6l">
          <button
            aria-expanded="false"
            aria-label="Menu"
            aria-controls="starlight__sidebar"
            class="sl-flex md:sl-hidden astro-tzz67r6l"
          >
            <svg
              aria-hidden="true"
              class="astro-tzz67r6l astro-mzbodlcp"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="currentColor"
              style="--sl-icon-size: 1em"
            >
              <path
                d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"
              />
            </svg>
          </button>
        </starlight-menu-button>
        <div id="starlight__sidebar" class="sidebar-pane astro-444rl2wv">
          <div class="sidebar-content sl-flex astro-444rl2wv">
            <sl-sidebar-state-persist
              data-hash="01kof5i"
              class="astro-epwuevht"
            >
              <ul class="top-level astro-tkdbfgf4">
                <li class="astro-tkdbfgf4">
                  <details open class="astro-tkdbfgf4">
                    <summary class="astro-tkdbfgf4">
                      <div class="group-label astro-tkdbfgf4">
                        <span class="large astro-tkdbfgf4">Introduction</span>
                      </div>
                      <svg
                        aria-hidden="true"
                        class="caret astro-tkdbfgf4 astro-mzbodlcp"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                        style="--sl-icon-size: 1.25rem"
                      >
                        <path
                          d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                        />
                      </svg>
                    </summary>
                    <ul class="astro-tkdbfgf4">
                      <li class="astro-tkdbfgf4">
                        <a
                          href="/introduction/101-introduction_jp/"
                          class="astro-tkdbfgf4"
                        >
                          <span class="astro-tkdbfgf4">Effectへようこそ</span>
                        </a>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <a
                          href="/introduction/201-why-effect_jp/"
                          class="astro-tkdbfgf4"
                        >
                          <span class="astro-tkdbfgf4">なぜEffectなのか？</span>
                        </a>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <a
                          href="/introduction/300-quickstart_ja/"
                          class="astro-tkdbfgf4"
                        >
                          <span class="astro-tkdbfgf4">クイックスタート</span>
                        </a>
                      </li>
                    </ul>
                  </details>
                </li>
                <li class="astro-tkdbfgf4">
                  <details open class="astro-tkdbfgf4">
                    <summary class="astro-tkdbfgf4">
                      <div class="group-label astro-tkdbfgf4">
                        <span class="large astro-tkdbfgf4">Guides</span>
                      </div>
                      <svg
                        aria-hidden="true"
                        class="caret astro-tkdbfgf4 astro-mzbodlcp"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                        style="--sl-icon-size: 1.25rem"
                      >
                        <path
                          d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                        />
                      </svg>
                    </summary>
                    <ul class="astro-tkdbfgf4">
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Effect Essentials</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/effect-essentials/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Effect Essentials</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/effect-essentials/100-importing-effect/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Effectのインポート</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/effect-essentials/200-the-effect-type_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Effect型</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/effect-essentials/300-creating-effects_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Effectの作成</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/effect-essentials/400-running-effects_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Effectの実行</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/effect-essentials/500-using-generators_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Effectにおけるジェネレーターの使用</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/effect-essentials/600-pipeline_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >パイプラインの構築</span
                                >
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Error Management</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Error Management</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/100-two-error-typesmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >二種類のエラー</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/1000-error-channel-operationsmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >エラーチャンネル操作</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/1100-sequential-and-parallel-errorsmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >並行および逐次エラー</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/1200-yieldable-errorsmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Yield可能なエラー</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/200-expected-errorsmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >予期されるエラー</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/300-unexpected-errorsmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >予期しないエラー</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/400-fallbackmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >フォールバック</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/500-matchingmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">マッチング</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/600-retryingmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">再試行</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/700-timing-outmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">タイムアウト</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/800-sandboxingmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >サンドボックス化</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/error-management/900-error-accumulationmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">エラーの蓄積</span>
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Resource Management</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/resource-management/100-scopemdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">スコープ</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <details open class="astro-tkdbfgf4">
                                <summary class="astro-tkdbfgf4">
                                  <div class="group-label astro-tkdbfgf4">
                                    <span class="large astro-tkdbfgf4"
                                      >patterns</span
                                    >
                                  </div>
                                  <svg
                                    aria-hidden="true"
                                    class="caret astro-tkdbfgf4 astro-mzbodlcp"
                                    width="16"
                                    height="16"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                    style="--sl-icon-size: 1.25rem"
                                  >
                                    <path
                                      d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                                    />
                                  </svg>
                                </summary>
                                <ul class="astro-tkdbfgf4">
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/resource-management/patterns/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Patterns</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/resource-management/patterns/100-sequence-of-operations-with-compensating-actions-on-failuremdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >失敗時の補償アクションを伴う操作のシーケンス</span
                                      >
                                    </a>
                                  </li>
                                </ul>
                              </details>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/resource-management/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Resource Management</span
                                >
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Requirements Management</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/requirements-management/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Requirements Management</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/requirements-management/100-servicesmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >サービスの管理</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/requirements-management/200-default-servicesmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >デフォルトサービス</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/requirements-management/300-layersmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >レイヤーの管理</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/requirements-management/400-dependency-memoizationmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >レイヤーのメモ化</span
                                >
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Observability</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/observability/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Observability</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/observability/100-loggingmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">ロギング</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/observability/200-supervisormdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Supervisor</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <details open class="astro-tkdbfgf4">
                                <summary class="astro-tkdbfgf4">
                                  <div class="group-label astro-tkdbfgf4">
                                    <span class="large astro-tkdbfgf4"
                                      >Telemetry</span
                                    >
                                  </div>
                                  <svg
                                    aria-hidden="true"
                                    class="caret astro-tkdbfgf4 astro-mzbodlcp"
                                    width="16"
                                    height="16"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                    style="--sl-icon-size: 1.25rem"
                                  >
                                    <path
                                      d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                                    />
                                  </svg>
                                </summary>
                                <ul class="astro-tkdbfgf4">
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/observability/telemetry/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Telemetry</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/observability/telemetry/100-intromdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Effectにおけるテレメトリの紹介</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/observability/telemetry/200-metricsmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Effectにおけるメトリクスの導入</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/observability/telemetry/300-tracingmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Effectにおけるトレーシングの導入</span
                                      >
                                    </a>
                                  </li>
                                </ul>
                              </details>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <a href="/guides/configuration/" class="astro-tkdbfgf4">
                          <span class="astro-tkdbfgf4">Configuration</span>
                        </a>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <a
                          href="/guides/500-runtimemdx_ja/"
                          class="astro-tkdbfgf4"
                        >
                          <span class="astro-tkdbfgf4"
                            >実行時システムの紹介(Introduction to Runtime)</span
                          >
                        </a>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Sceduling</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/sceduling/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Scheduling</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/sceduling/100-introductionmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >スケジューリングの紹介</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/sceduling/200-repetitionmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">繰り返し</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/sceduling/300-built-in-schedulesmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >組み込みスケジュール</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/sceduling/400-schedule-combinatorsmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >スケジュール・コンビネータ</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/sceduling/500-examplesmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">例</span>
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >State Management</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/state-management/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >State Management</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/state-management/100-refmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Ref</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/state-management/200-synchronizedrefmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >SynchronizedRef</span
                                >
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <a
                          href="/guides/620-batching-cachingmdx_ja/"
                          aria-current="page"
                          class="astro-tkdbfgf4"
                        >
                          <span class="astro-tkdbfgf4">Batching</span>
                        </a>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4">Caching</span>
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a href="/guides/caching/" class="astro-tkdbfgf4">
                                <span class="astro-tkdbfgf4">Caching</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/caching/100-effect-cachingmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >キャッシングエフェクト</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/caching/200-cachemdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">キャッシュ</span>
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Concurrency</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Concurrency</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/100-concurrency-optionsmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >同時実行オプション</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/110-fibersmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Fibers</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/120-interruption-modelmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >Effectの障害モデル入門</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/130-deferredmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Deferred</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/140-queuemdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">キュー</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/150-pubsubmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">PubSub</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/160-semaphoremdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">セマフォ</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/concurrency/50-basic-concurrencymdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >基本的な並行処理</span
                                >
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Streaming</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/streaming/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Streaming</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/streaming/300-subscriptionrefmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >SubscriptionRef</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <details open class="astro-tkdbfgf4">
                                <summary class="astro-tkdbfgf4">
                                  <div class="group-label astro-tkdbfgf4">
                                    <span class="large astro-tkdbfgf4"
                                      >Stream</span
                                    >
                                  </div>
                                  <svg
                                    aria-hidden="true"
                                    class="caret astro-tkdbfgf4 astro-mzbodlcp"
                                    width="16"
                                    height="16"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                    style="--sl-icon-size: 1.25rem"
                                  >
                                    <path
                                      d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                                    />
                                  </svg>
                                </summary>
                                <ul class="astro-tkdbfgf4">
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/stream/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Streams</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/stream/100-introductionmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >ストリーム入門</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/stream/200-creatingmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >ストリームの作成</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/stream/300-resourceful-streamsmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >リソースフルなストリーム</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/stream/400-operations/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Operations</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/stream/500-consuming-streamsmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >ストリームの消費</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/stream/600-error-handlingmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >ストリームにおけるエラー処理</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/stream/700-schedulingmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >ストリームのスケジューリング</span
                                      >
                                    </a>
                                  </li>
                                </ul>
                              </details>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <details open class="astro-tkdbfgf4">
                                <summary class="astro-tkdbfgf4">
                                  <div class="group-label astro-tkdbfgf4">
                                    <span class="large astro-tkdbfgf4"
                                      >Sink</span
                                    >
                                  </div>
                                  <svg
                                    aria-hidden="true"
                                    class="caret astro-tkdbfgf4 astro-mzbodlcp"
                                    width="16"
                                    height="16"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                    style="--sl-icon-size: 1.25rem"
                                  >
                                    <path
                                      d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                                    />
                                  </svg>
                                </summary>
                                <ul class="astro-tkdbfgf4">
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/sink/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4">Sinks</span>
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/sink/100-introductionmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Sinksの紹介</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/sink/200-creatingmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Sinksの作成</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/sink/300-operationsmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Sink Operations</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/sink/400-parallel-operatorsmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >並行演算子</span
                                      >
                                    </a>
                                  </li>
                                  <li class="astro-tkdbfgf4">
                                    <a
                                      href="/guides/streaming/sink/500-leftoversmdx_ja/"
                                      class="astro-tkdbfgf4"
                                    >
                                      <span class="astro-tkdbfgf4"
                                        >Leftovers</span
                                      >
                                    </a>
                                  </li>
                                </ul>
                              </details>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4">Testing</span>
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a href="/guides/testing/" class="astro-tkdbfgf4">
                                <span class="astro-tkdbfgf4">Testing</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/testing/100-testclockmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">TestClock</span>
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <a
                          href="/guides/700-control-flowmdx_ja/"
                          class="astro-tkdbfgf4"
                        >
                          <span class="astro-tkdbfgf4"
                            >Effectの制御フロー演算子入門</span
                          >
                        </a>
                      </li>
                      <li class="astro-tkdbfgf4">
                        <details open class="astro-tkdbfgf4">
                          <summary class="astro-tkdbfgf4">
                            <div class="group-label astro-tkdbfgf4">
                              <span class="large astro-tkdbfgf4"
                                >Code Style</span
                              >
                            </div>
                            <svg
                              aria-hidden="true"
                              class="caret astro-tkdbfgf4 astro-mzbodlcp"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                              style="--sl-icon-size: 1.25rem"
                            >
                              <path
                                d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                              />
                            </svg>
                          </summary>
                          <ul class="astro-tkdbfgf4">
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/code-style/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">Code Style</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/code-style/100-dualmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">デュアルAPI</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/code-style/200-branded-typesmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">ブランド型</span>
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/code-style/300-pattern-matchingmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >パターンマッチング</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/code-style/400-domdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4"
                                  >過剰なネストを簡素化する</span
                                >
                              </a>
                            </li>
                            <li class="astro-tkdbfgf4">
                              <a
                                href="/guides/code-style/500-guidelinesmdx_ja/"
                                class="astro-tkdbfgf4"
                              >
                                <span class="astro-tkdbfgf4">ガイドライン</span>
                              </a>
                            </li>
                          </ul>
                        </details>
                      </li>
                    </ul>
                  </details>
                </li>
                <li class="astro-tkdbfgf4">
                  <details open class="astro-tkdbfgf4">
                    <summary class="astro-tkdbfgf4">
                      <div class="group-label astro-tkdbfgf4">
                        <span class="large astro-tkdbfgf4">Blog</span>
                      </div>
                      <svg
                        aria-hidden="true"
                        class="caret astro-tkdbfgf4 astro-mzbodlcp"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                        style="--sl-icon-size: 1.25rem"
                      >
                        <path
                          d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                        />
                      </svg>
                    </summary>
                    <ul class="astro-tkdbfgf4"></ul>
                  </details>
                </li>
              </ul>
            </sl-sidebar-state-persist>
            <div class="md:sl-hidden astro-epwuevht">
              <div class="mobile-preferences sl-flex astro-misogbc3">
                <div class="sl-flex social-icons astro-misogbc3">
                  <a
                    href="https://github.com/withastro/starlight"
                    rel="me"
                    class="sl-flex astro-a5kxgq6d"
                    ><span class="sr-only astro-a5kxgq6d">GitHub</span
                    ><svg
                      aria-hidden="true"
                      class="astro-a5kxgq6d astro-mzbodlcp"
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                      style="--sl-icon-size: 1em"
                    >
                      <path
                        d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"
                      />
                    </svg>
                  </a>
                </div>
                <starlight-theme-select>
                  <label
                    style="--sl-select-width: 6.25em"
                    class="astro-6mzzj2bg"
                  >
                    <span class="sr-only astro-6mzzj2bg">Select theme</span>
                    <svg
                      aria-hidden="true"
                      class="icon label-icon astro-6mzzj2bg astro-mzbodlcp"
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                      style="--sl-icon-size: 1em"
                    >
                      <path
                        d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"
                      />
                    </svg>
                    <select value="auto" class="astro-6mzzj2bg">
                      <option value="dark" class="astro-6mzzj2bg">Dark</option>
                      <option value="light" class="astro-6mzzj2bg">
                        Light
                      </option>
                      <option
                        value="auto"
                        selected="true"
                        class="astro-6mzzj2bg"
                      >
                        Auto
                      </option>
                    </select>
                    <svg
                      aria-hidden="true"
                      class="icon caret astro-6mzzj2bg astro-mzbodlcp"
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                      style="--sl-icon-size: 1em"
                    >
                      <path
                        d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"
                      />
                    </svg>
                  </label>
                </starlight-theme-select>
                <script>
                  StarlightThemeProvider.updatePickers();
                </script>
              </div>
            </div>
            <script>
              (() => {
                try {
                  if (!matchMedia("(min-width: 50em)").matches) return;
                  const scroller =
                    document.getElementById("starlight__sidebar");
                  /** @type {HTMLElement | null} */
                  const target = document.querySelector(
                    "sl-sidebar-state-persist",
                  );
                  const state = JSON.parse(
                    sessionStorage.getItem("sl-sidebar-state") || "0",
                  );
                  if (
                    !scroller ||
                    !target ||
                    !state ||
                    target.dataset.hash !== state.hash
                  )
                    return;
                  target
                    .querySelectorAll("details")
                    .forEach(
                      (el, idx) =>
                        typeof state.open[idx] === "boolean" &&
                        (el.open = state.open[idx]),
                    );
                  scroller.scrollTop = state.scroll;
                } catch {}
              })();
            </script>
          </div>
        </div>
      </nav>
      <div class="main-frame astro-444rl2wv">
        <div class="lg:sl-flex astro-iia7liwg">
          <aside class="right-sidebar-container astro-iia7liwg">
            <div class="right-sidebar astro-iia7liwg">
              <div class="lg:sl-hidden astro-mgyjzhcd">
                <mobile-starlight-toc
                  data-min-h="2"
                  data-max-h="3"
                  class="astro-i5ioxqqj"
                  ><nav
                    aria-labelledby="starlight__on-this-page--mobile"
                    class="astro-i5ioxqqj"
                  >
                    <details id="starlight__mobile-toc" class="astro-i5ioxqqj">
                      <summary
                        id="starlight__on-this-page--mobile"
                        class="sl-flex astro-i5ioxqqj"
                      >
                        <div class="toggle sl-flex astro-i5ioxqqj">
                          On this page<svg
                            aria-hidden="true"
                            class="caret astro-i5ioxqqj astro-mzbodlcp"
                            width="16"
                            height="16"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                            style="--sl-icon-size: 1rem"
                          >
                            <path
                              d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"
                            />
                          </svg>
                        </div>
                        <span class="display-current astro-i5ioxqqj"></span>
                      </summary>
                      <div class="dropdown astro-i5ioxqqj">
                        <ul class="isMobile astro-wbc2ynvf" style="--depth: 0">
                          <li class="astro-wbc2ynvf" style="--depth: 0">
                            <a
                              href="#_top"
                              class="astro-wbc2ynvf"
                              style="--depth: 0"
                            >
                              <span class="astro-wbc2ynvf" style="--depth: 0"
                                >Overview</span
                              >
                            </a>
                          </li>
                          <li class="astro-wbc2ynvf" style="--depth: 0">
                            <a
                              href="#api-統合の古典的アプローチ"
                              class="astro-wbc2ynvf"
                              style="--depth: 0"
                            >
                              <span class="astro-wbc2ynvf" style="--depth: 0"
                                >API 統合の古典的アプローチ</span
                              >
                            </a>
                            <ul
                              class="isMobile astro-wbc2ynvf"
                              style="--depth: 1"
                            >
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#シンプルなモデル設定"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >シンプルなモデル設定</span
                                  >
                                </a>
                              </li>
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#api-関数の定義"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >API 関数の定義</span
                                  >
                                </a>
                              </li>
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#api-関数の使用"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >API 関数の使用</span
                                  >
                                </a>
                              </li>
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#バッチコールによる効率の改善"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >バッチコールによる効率の改善</span
                                  >
                                </a>
                              </li>
                            </ul>
                          </li>
                          <li class="astro-wbc2ynvf" style="--depth: 0">
                            <a
                              href="#バッチ処理"
                              class="astro-wbc2ynvf"
                              style="--depth: 0"
                            >
                              <span class="astro-wbc2ynvf" style="--depth: 0"
                                >バッチ処理</span
                              >
                            </a>
                            <ul
                              class="isMobile astro-wbc2ynvf"
                              style="--depth: 1"
                            >
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#リクエストの宣言"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >リクエストの宣言</span
                                  >
                                </a>
                              </li>
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#リゾルバの宣言"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >リゾルバの宣言</span
                                  >
                                </a>
                              </li>
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#クエリの定義"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >クエリの定義</span
                                  >
                                </a>
                              </li>
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#バッチ処理の無効化"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >バッチ処理の無効化</span
                                  >
                                </a>
                              </li>
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#コンテキストを持つリゾルバ"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >コンテキストを持つリゾルバ</span
                                  >
                                </a>
                              </li>
                            </ul>
                          </li>
                          <li class="astro-wbc2ynvf" style="--depth: 0">
                            <a
                              href="#キャッシング"
                              class="astro-wbc2ynvf"
                              style="--depth: 0"
                            >
                              <span class="astro-wbc2ynvf" style="--depth: 0"
                                >キャッシング</span
                              >
                            </a>
                          </li>
                          <li class="astro-wbc2ynvf" style="--depth: 0">
                            <a
                              href="#最終プログラム"
                              class="astro-wbc2ynvf"
                              style="--depth: 0"
                            >
                              <span class="astro-wbc2ynvf" style="--depth: 0"
                                >最終プログラム</span
                              >
                            </a>
                          </li>
                          <li class="astro-wbc2ynvf" style="--depth: 0">
                            <a
                              href="#リクエストキャッシングのカスタマイズ"
                              class="astro-wbc2ynvf"
                              style="--depth: 0"
                            >
                              <span class="astro-wbc2ynvf" style="--depth: 0"
                                >リクエストキャッシングのカスタマイズ</span
                              >
                            </a>
                            <ul
                              class="isMobile astro-wbc2ynvf"
                              style="--depth: 1"
                            >
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#カスタムキャッシュの作成"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >カスタムキャッシュの作成</span
                                  >
                                </a>
                              </li>
                              <li class="astro-wbc2ynvf" style="--depth: 1">
                                <a
                                  href="#キャッシュの直接適用"
                                  class="astro-wbc2ynvf"
                                  style="--depth: 1"
                                >
                                  <span
                                    class="astro-wbc2ynvf"
                                    style="--depth: 1"
                                    >キャッシュの直接適用</span
                                  >
                                </a>
                              </li>
                            </ul>
                          </li>
                        </ul>
                      </div>
                    </details>
                  </nav></mobile-starlight-toc
                >
              </div>
              <div
                class="right-sidebar-panel sl-hidden lg:sl-block astro-mgyjzhcd"
              >
                <div class="sl-container astro-mgyjzhcd">
                  <starlight-toc data-min-h="2" data-max-h="3"
                    ><nav aria-labelledby="starlight__on-this-page">
                      <h2 id="starlight__on-this-page">On this page</h2>
                      <ul class="astro-wbc2ynvf" style="--depth: 0">
                        <li class="astro-wbc2ynvf" style="--depth: 0">
                          <a
                            href="#_top"
                            class="astro-wbc2ynvf"
                            style="--depth: 0"
                          >
                            <span class="astro-wbc2ynvf" style="--depth: 0"
                              >Overview</span
                            >
                          </a>
                        </li>
                        <li class="astro-wbc2ynvf" style="--depth: 0">
                          <a
                            href="#api-統合の古典的アプローチ"
                            class="astro-wbc2ynvf"
                            style="--depth: 0"
                          >
                            <span class="astro-wbc2ynvf" style="--depth: 0"
                              >API 統合の古典的アプローチ</span
                            >
                          </a>
                          <ul class="astro-wbc2ynvf" style="--depth: 1">
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#シンプルなモデル設定"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >シンプルなモデル設定</span
                                >
                              </a>
                            </li>
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#api-関数の定義"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >API 関数の定義</span
                                >
                              </a>
                            </li>
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#api-関数の使用"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >API 関数の使用</span
                                >
                              </a>
                            </li>
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#バッチコールによる効率の改善"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >バッチコールによる効率の改善</span
                                >
                              </a>
                            </li>
                          </ul>
                        </li>
                        <li class="astro-wbc2ynvf" style="--depth: 0">
                          <a
                            href="#バッチ処理"
                            class="astro-wbc2ynvf"
                            style="--depth: 0"
                          >
                            <span class="astro-wbc2ynvf" style="--depth: 0"
                              >バッチ処理</span
                            >
                          </a>
                          <ul class="astro-wbc2ynvf" style="--depth: 1">
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#リクエストの宣言"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >リクエストの宣言</span
                                >
                              </a>
                            </li>
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#リゾルバの宣言"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >リゾルバの宣言</span
                                >
                              </a>
                            </li>
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#クエリの定義"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >クエリの定義</span
                                >
                              </a>
                            </li>
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#バッチ処理の無効化"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >バッチ処理の無効化</span
                                >
                              </a>
                            </li>
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#コンテキストを持つリゾルバ"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >コンテキストを持つリゾルバ</span
                                >
                              </a>
                            </li>
                          </ul>
                        </li>
                        <li class="astro-wbc2ynvf" style="--depth: 0">
                          <a
                            href="#キャッシング"
                            class="astro-wbc2ynvf"
                            style="--depth: 0"
                          >
                            <span class="astro-wbc2ynvf" style="--depth: 0"
                              >キャッシング</span
                            >
                          </a>
                        </li>
                        <li class="astro-wbc2ynvf" style="--depth: 0">
                          <a
                            href="#最終プログラム"
                            class="astro-wbc2ynvf"
                            style="--depth: 0"
                          >
                            <span class="astro-wbc2ynvf" style="--depth: 0"
                              >最終プログラム</span
                            >
                          </a>
                        </li>
                        <li class="astro-wbc2ynvf" style="--depth: 0">
                          <a
                            href="#リクエストキャッシングのカスタマイズ"
                            class="astro-wbc2ynvf"
                            style="--depth: 0"
                          >
                            <span class="astro-wbc2ynvf" style="--depth: 0"
                              >リクエストキャッシングのカスタマイズ</span
                            >
                          </a>
                          <ul class="astro-wbc2ynvf" style="--depth: 1">
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#カスタムキャッシュの作成"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >カスタムキャッシュの作成</span
                                >
                              </a>
                            </li>
                            <li class="astro-wbc2ynvf" style="--depth: 1">
                              <a
                                href="#キャッシュの直接適用"
                                class="astro-wbc2ynvf"
                                style="--depth: 1"
                              >
                                <span class="astro-wbc2ynvf" style="--depth: 1"
                                  >キャッシュの直接適用</span
                                >
                              </a>
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </nav></starlight-toc
                  >
                </div>
              </div>
            </div>
          </aside>
          <div class="main-pane astro-iia7liwg">
            <main data-pagefind-body lang="en" dir="ltr" class="astro-ds2wt7hw">
              <div class="content-panel astro-qq65ezpp">
                <div class="sl-container astro-qq65ezpp">
                  <h1 id="_top" class="astro-hbp5tgjk">Batching</h1>
                </div>
              </div>
              <div class="content-panel astro-qq65ezpp">
                <div class="sl-container astro-qq65ezpp">
                  <div class="sl-markdown-content">
                    <h2 id="api-統合の古典的アプローチ">
                      API 統合の古典的アプローチ
                    </h2>
                    <p>
                      一般的なアプリケーション開発では、外部
                      API、データベース、その他のデータソースとやり取りする際に、リクエストを行い、その結果や失敗を適切に処理する関数を定義することがよくあります。
                    </p>
                    <h3 id="シンプルなモデル設定">シンプルなモデル設定</h3>
                    <p>
                      ここでは、データの構造と可能なエラーを概要する基本的なモデルを示します。
                    </p>
                    <div class="expressive-code">
                      <link rel="stylesheet" href="/_astro/ec.j8ofn.css" />
                      <script type="module" src="/_astro/ec.8zarh.js"></script>
                      <figure class="frame not-content">
                        <figcaption class="header"></figcaption>
                        <pre
                          data-language="twoslash"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export interface User {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly _tag: "User"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly id: number</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly name: string</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly email: string</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export class GetUserError {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly _tag = "GetUserError"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export interface Todo {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly _tag: "Todo"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly id: number</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly message: string</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly ownerId: number</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export class GetTodosError {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly _tag = "GetTodosError"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export class SendEmailError {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly _tag = "SendEmailError"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">}</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="export interface User {  readonly _tag: &#x22;User&#x22;  readonly id: number  readonly name: string  readonly email: string}export class GetUserError {  readonly _tag = &#x22;GetUserError&#x22;}export interface Todo {  readonly _tag: &#x22;Todo&#x22;  readonly id: number  readonly message: string  readonly ownerId: number}export class GetTodosError {  readonly _tag = &#x22;GetTodosError&#x22;}export class SendEmailError {  readonly _tag = &#x22;SendEmailError&#x22;}"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <div class="expressive-code">
                      <figure class="frame not-content">
                        <figcaption class="header"></figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <aside
                      aria-label="Tip"
                      class="starlight-aside starlight-aside--tip"
                    >
                      <p class="starlight-aside__title" aria-hidden="true">
                        <svg
                          viewBox="0 0 24 24"
                          width="16"
                          height="16"
                          fill="currentColor"
                          class="starlight-aside__icon"
                        >
                          <path
                            d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2l0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4l0 0c19.8 27.1 39.7 54.4 49.2 86.2H272zM192 512c44.2 0 80-35.8 80-80V416H112v16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"
                          ></path>
                          <path
                            d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2l0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4l0 0c19.8 27.1 39.7 54.4 49.2 86.2H272zM192 512c44.2 0 80-35.8 80-80V416H112v16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"
                          ></path></svg
                        >Tip
                      </p>
                      <section class="starlight-aside__content">
                        <p>
                          実際のシナリオでは、識別子にプリミティブを直接使用するのではなく、より正確なタイプを使用することを検討するかもしれません（<a
                            href="style/branded-types"
                            >ブランド付きタイプ</a
                          >を参照）。さらに、エラーにもっと詳細な情報を含めることを検討するかもしれません。
                        </p>
                      </section>
                    </aside>
                    <h3 id="api-関数の定義">API 関数の定義</h3>
                    <p>
                      外部 API とやり取りし、TODO
                      の取得、ユーザー詳細の取得、メールの送信などの一般的な操作を処理する関数を定義してみましょう。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame not-content">
                        <figcaption class="header"></figcaption>
                        <pre
                          data-language="twoslash"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import { Effect } from "effect"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Model from "./Model"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// 外部APIからTODOのリストを取得します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const getTodos = Effect.tryPromise({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">try: () =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">fetch("https://api.example.demo/todos").then(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">(res) => res.json() as Promise&#x3C;Array&#x3C;Model.Todo>></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">catch: () => new Model.GetTodosError()</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">})</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// 外部APIからIDを使用してユーザーを取得します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const getUserById = (id: number) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.tryPromise({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">try: () =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">fetch(`https://api.example.demo/getUserById?id=${id}`).then(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">(res) => res.json() as Promise&#x3C;Model.User></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">catch: () => new Model.GetUserError()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">})</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// 外部APIを通じてメールを送信します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const sendEmail = (address: string, text: string) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.tryPromise({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">try: () =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">fetch("https://api.example.demo/sendEmail", {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">method: "POST",</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">headers: {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">"Content-Type": "application/json"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">body: JSON.stringify({ address, text })</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">}).then((res) => res.json() as Promise&#x3C;void>),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">catch: () => new Model.SendEmailError()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">})</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// ユーザーの詳細を取得してからユーザーにメールを送信します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const sendEmailToUser = (id: number, message: string) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">getUserById(id).pipe(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.andThen((user) => sendEmail(user.email, message))</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// TODOの所有者に通知をし、メールを送信します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const notifyOwner = (todo: Model.Todo) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">getUserById(todo.ownerId).pipe(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.andThen((user) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">sendEmailToUser(user.id, `hey ${user.name} you got a todo!`)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="import { Effect } from &#x22;effect&#x22;import * as Model from &#x22;./Model&#x22;// 外部APIからTODOのリストを取得しますexport const getTodos = Effect.tryPromise({  try: () =>    fetch(&#x22;https://api.example.demo/todos&#x22;).then(      (res) => res.json() as Promise<Array<Model.Todo>>    ),  catch: () => new Model.GetTodosError()})// 外部APIからIDを使用してユーザーを取得しますexport const getUserById = (id: number) =>  Effect.tryPromise({    try: () =>      fetch(&#x60;https://api.example.demo/getUserById?id=${id}&#x60;).then(        (res) => res.json() as Promise<Model.User>      ),    catch: () => new Model.GetUserError()  })// 外部APIを通じてメールを送信しますexport const sendEmail = (address: string, text: string) =>  Effect.tryPromise({    try: () =>      fetch(&#x22;https://api.example.demo/sendEmail&#x22;, {        method: &#x22;POST&#x22;,        headers: {          &#x22;Content-Type&#x22;: &#x22;application/json&#x22;        },        body: JSON.stringify({ address, text })      }).then((res) => res.json() as Promise<void>),    catch: () => new Model.SendEmailError()  })// ユーザーの詳細を取得してからユーザーにメールを送信しますexport const sendEmailToUser = (id: number, message: string) =>  getUserById(id).pipe(    Effect.andThen((user) => sendEmail(user.email, message))  )// TODOの所有者に通知をし、メールを送信しますexport const notifyOwner = (todo: Model.Todo) =>  getUserById(todo.ownerId).pipe(    Effect.andThen((user) =>      sendEmailToUser(user.id, &#x60;hey ${user.name} you got a todo!&#x60;)    )  )"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// ---cut---// @include: API"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <aside
                      aria-label="Tip"
                      class="starlight-aside starlight-aside--tip"
                    >
                      <p class="starlight-aside__title" aria-hidden="true">
                        <svg
                          viewBox="0 0 24 24"
                          width="16"
                          height="16"
                          fill="currentColor"
                          class="starlight-aside__icon"
                        >
                          <path
                            d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2l0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4l0 0c19.8 27.1 39.7 54.4 49.2 86.2H272zM192 512c44.2 0 80-35.8 80-80V416H112v16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"
                          ></path>
                          <path
                            d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2l0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4l0 0c19.8 27.1 39.7 54.4 49.2 86.2H272zM192 512c44.2 0 80-35.8 80-80V416H112v16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"
                          ></path></svg
                        >Tip
                      </p>
                      <section class="starlight-aside__content">
                        <p>
                          実際のシナリオでは、API
                          が常に期待されるデータを返すと信頼しないほうが良いかもしれません。このためには、<code
                            dir="auto"
                            >@effect/schema</code
                          >や<code dir="auto">zod</code
                          >などの代替手段を検討できます。
                        </p>
                      </section>
                    </aside>
                    <p>
                      このアプローチはシンプルで読みやすいですが、最も効率的でない可能性があります。同じ所有者を持つ多くの
                      TODO がある場合、繰り返し API
                      コールを行うことは、ネットワークオーバーヘッドを大幅に増加させ、アプリケーションの遅延を引き起こす可能性があります。
                    </p>
                    <h3 id="api-関数の使用">API 関数の使用</h3>
                    <p>
                      これらの関数は明解で理解しやすいですが、その使用は最も効率的ではないかもしれません。例えば、TODO
                      の所有者を通知する際は、繰り返し API
                      コールが発生し、最適化できる可能性があります。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: index.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> API </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./API</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// TODOのオペレーションを調整し、所有者に通知します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">gen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function* </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">todos</span><span style="--0:#C792EA;--1:#8D46B4"> = yield* </span><span style="--0:#82AAFF;--1:#3C63B3">API</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">getTodos</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">yield* </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">forEach</span><span style="--0:#D6DEEB;--1:#403F53">(todos</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">todo</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#82AAFF;--1:#3C63B3">API</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">notifyOwner</span><span style="--0:#D6DEEB;--1:#403F53">(todo)</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">concurrency: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">unbounded</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#7690A6;--1:#4F687D">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: index.ts// ---cut---import { Effect } from &#x22;effect&#x22;;import * as API from &#x22;./API&#x22;;// TODOのオペレーションを調整し、所有者に通知しますconst program = Effect.gen(function* () {  const todos = yield* API.getTodos;  yield* Effect.forEach(todos, (todo) => API.notifyOwner(todo), {    concurrency: &#x22;unbounded&#x22;,  });});"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      この実装は、メールを送信するために各 TODO
                      に対して所有者の詳細を取得する API
                      コールを実行します。同じ所有者を持つ複数の TODO
                      がある場合、冗長な API コールが発生します。
                    </p>
                    <h3 id="バッチコールによる効率の改善">
                      バッチコールによる効率の改善
                    </h3>
                    <p>
                      最適化を図るため、バックエンドがサポートしている場合はバッチ
                      API
                      コールを実装することを検討してください。これにより、複数の操作を単一のリクエストにグループ化し、HTTP
                      リクエストの数を減少させ、パフォーマンスを向上させ、負荷を軽減できます。
                    </p>
                    <p><strong>次のステップ：</strong></p>
                    <p>
                      可能な限りバッチ処理を使用するよう API
                      との相互作用をリファクタリングします。これにより、サーバーの負荷が軽減されるだけでなく、データの処理も効率化され、コードが効率的でクリーンのまま保たれます。
                    </p>
                    <h2 id="バッチ処理">バッチ処理</h2>
                    <p>
                      バッチで API コールを行うことで、HTTP
                      リクエストの数を削減し、アプリケーションのパフォーマンスを大幅に向上させることができます。
                    </p>
                    <p>
                      ここでは、<code dir="auto">getUserById</code>と<code
                        dir="auto"
                        >sendEmail</code
                      >をバッチ処理できると仮定しましょう。つまり、単一の HTTP
                      コールで複数のリクエストを送信でき、API
                      リクエストの数を減らし、パフォーマンスを向上させることができます。
                    </p>
                    <p>
                      <strong>バッチ処理のステップバイステップガイド</strong>
                    </p>
                    <ol>
                      <li>
                        <p>
                          <strong>リクエストの構造化：</strong>
                          リクエストを構造化データモデルに変換することから始めます。これには、入力パラメータ、期待される出力、可能なエラーを詳細に記述することが含まれます。このようにリクエストを構造化することにより、データの効率的な管理が可能になるだけでなく、異なるリクエストを比較して同じ入力パラメータを参照しているかどうかを理解するのにも役立ちます。
                        </p>
                      </li>
                      <li>
                        <p>
                          <strong>リゾルバの定義：</strong>
                          リゾルバは、複数のリクエストを同時に処理するために設計されています。リクエストを比較（同じ入力パラメータを参照していることを確認）する能力を活用することで、リゾルバは複数のリクエストを一度に実行し、バッチ処理の効果を最大限に引き出すことができます。
                        </p>
                      </li>
                      <li>
                        <p>
                          <strong>クエリの作成：</strong>
                          最後に、これらのバッチリゾルバを利用して操作を行うクエリを定義します。このステップでは、構造化されたリクエストとそれに対応するリゾルバをアプリケーションの機能コンポーネントとして結びつけます。
                        </p>
                      </li>
                    </ol>
                    <p><strong>重要な考慮事項</strong></p>
                    <p>
                      リクエストは比較可能な方法でモデリングされる必要があります。これにより、同一のリクエストを特定してバッチ処理できるように、比較の実装（<a
                        href="../other/trait/equal"
                        >Equals.equals</a
                      >のようなメソッドを使用）を行うことが重要です。
                    </p>
                    <h3 id="リクエストの宣言">リクエストの宣言</h3>
                    <p>
                      データソースが処理できるリクエストのタイプに対して構造化されたモデルを定義することから始めましょう。データソースがサポートするかもしれない<code
                        dir="auto"
                        >Request</code
                      >という概念を使用してモデルを設計します。
                    </p>
                    <p>
                      <code dir="auto">Request&#x3C;Value, Error></code
                      >は、タイプ<code dir="auto">Value</code
                      >の値に対するリクエストを表す構造で、<code dir="auto"
                        >Error</code
                      >タイプのエラーで失敗する可能性があります。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame not-content">
                        <figcaption class="header"></figcaption>
                        <pre
                          data-language="twoslash"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import { Request } from "effect"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Model from "./Model"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// 複数のTodoアイテムを取得するリクエストを定義します。このリクエストはGetTodosErrorで失敗する可能性があります。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export interface GetTodos</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">extends Request.Request&#x3C;Array&#x3C;Model.Todo>, Model.GetTodosError> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly _tag: "GetTodos"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// GetTodosリクエスト用のタグ付きコンストラクタを作成します。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const GetTodos = Request.tagged&#x3C;GetTodos>("GetTodos")</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// IDを使用してユーザーを取得するリクエストを定義します。このリクエストはGetUserErrorで失敗する可能性があります。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export interface GetUserById</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">extends Request.Request&#x3C;Model.User, Model.GetUserError> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly _tag: "GetUserById"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly id: number</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// GetUserByIdリクエスト用のタグ付きコンストラクタを作成します。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const GetUserById = Request.tagged&#x3C;GetUserById>("GetUserById")</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// メールを送信するリクエストを定義します。このリクエストはSendEmailErrorで失敗する可能性があります。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export interface SendEmail</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">extends Request.Request&#x3C;void, Model.SendEmailError> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly _tag: "SendEmail"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly address: string</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">readonly text: string</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// SendEmailリクエスト用のタグ付きコンストラクタを作成します。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const SendEmail = Request.tagged&#x3C;SendEmail>("SendEmail")</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// 簡単に管理できるようにすべてのリクエストをユニオン型にまとめます。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export type ApiRequest = GetTodos | GetUserById | SendEmail</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="import { Request } from &#x22;effect&#x22;import * as Model from &#x22;./Model&#x22;// 複数のTodoアイテムを取得するリクエストを定義します。このリクエストはGetTodosErrorで失敗する可能性があります。export interface GetTodos  extends Request.Request<Array<Model.Todo>, Model.GetTodosError> {  readonly _tag: &#x22;GetTodos&#x22;}// GetTodosリクエスト用のタグ付きコンストラクタを作成します。export const GetTodos = Request.tagged<GetTodos>(&#x22;GetTodos&#x22;)// IDを使用してユーザーを取得するリクエストを定義します。このリクエストはGetUserErrorで失敗する可能性があります。export interface GetUserById  extends Request.Request<Model.User, Model.GetUserError> {  readonly _tag: &#x22;GetUserById&#x22;  readonly id: number}// GetUserByIdリクエスト用のタグ付きコンストラクタを作成します。export const GetUserById = Request.tagged<GetUserById>(&#x22;GetUserById&#x22;)// メールを送信するリクエストを定義します。このリクエストはSendEmailErrorで失敗する可能性があります。export interface SendEmail  extends Request.Request<void, Model.SendEmailError> {  readonly _tag: &#x22;SendEmail&#x22;  readonly address: string  readonly text: string}// SendEmailリクエスト用のタグ付きコンストラクタを作成します。export const SendEmail = Request.tagged<SendEmail>(&#x22;SendEmail&#x22;)// 簡単に管理できるようにすべてのリクエストをユニオン型にまとめます。export type ApiRequest = GetTodos | GetUserById | SendEmail"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: Requests.ts// ---cut---// @include: Requests"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      個々のリクエストは、特定のデータ構造を持った要求を示すために、一般的な<code
                        dir="auto"
                        >Request</code
                      >タイプから拡張されています。これにより、それぞれのリクエストは特有のデータ要件と特定のエラータイプを持つことが保証されます。
                    </p>
                    <p>
                      タグ付きコンストラクタ<code dir="auto"
                        >Request.tagged</code
                      >を使用することで、アプリケーション全体で認識可能で管理可能なリクエストオブジェクトを簡単にインスタンス化できます。
                    </p>
                    <h3 id="リゾルバの宣言">リゾルバの宣言</h3>
                    <p>
                      リクエストを定義した後、次のステップは<code dir="auto"
                        >RequestResolver</code
                      >を使用して Effect
                      がこれらのリクエストを解決する方法を構成することです。<code
                        dir="auto"
                        >RequestResolver&#x3C;A, R></code
                      >は環境<code dir="auto">R</code>を必要とし、タイプ<code
                        dir="auto"
                        >A</code
                      >のリクエストを実行できるものです。
                    </p>
                    <p>
                      このセクションでは、各リクエストタイプの個別リゾルバを作成します。リゾルバの粒度は異なる場合がありますが、通常は対応する
                      API コールのバッチ処理能力に基づいて分割されます。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame not-content">
                        <figcaption class="header"></figcaption>
                        <pre
                          data-language="twoslash"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import { Effect, RequestResolver, Request } from "effect"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as API from "./API"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Model from "./Model"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Requests from "./Requests"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// GetTodosはバッチ処理できないと仮定し、標準的なリゾルバを作成します。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const GetTodosResolver = RequestResolver.fromEffect(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">(request: Requests.GetTodos) => API.getTodos</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// GetUserByIdはバッチ処理できると仮定し、バッチリゾルバを作成します。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const GetUserByIdResolver = RequestResolver.makeBatched(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">(requests: ReadonlyArray&#x3C;Requests.GetUserById>) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.tryPromise({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">try: () =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">fetch("https://api.example.demo/getUserByIdBatch", {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">method: "POST",</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">headers: {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">            </span></span><span style="--0:#d6deeb;--1:#403f53">"Content-Type": "application/json"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">body: JSON.stringify({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">            </span></span><span style="--0:#d6deeb;--1:#403f53">users: requests.map(({ id }) => ({ id }))</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">})</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">}).then((res) => res.json()) as Promise&#x3C;Array&#x3C;Model.User>>,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">catch: () => new Model.GetUserError()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">}).pipe(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.andThen((users) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.forEach(requests, (request, index) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">Request.completeEffect(request, Effect.succeed(users[index]))</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.catchAll((error) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.forEach(requests, (request) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">Request.completeEffect(request, Effect.fail(error))</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// SendEmailはバッチ処理できると仮定し、バッチリゾルバを作成します。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const SendEmailResolver = RequestResolver.makeBatched(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">(requests: ReadonlyArray&#x3C;Requests.SendEmail>) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.tryPromise({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">try: () =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">fetch("https://api.example.demo/sendEmailBatch", {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">method: "POST",</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">headers: {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">            </span></span><span style="--0:#d6deeb;--1:#403f53">"Content-Type": "application/json"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">body: JSON.stringify({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">            </span></span><span style="--0:#d6deeb;--1:#403f53">emails: requests.map(({ address, text }) => ({ address, text }))</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">})</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">}).then((res) => res.json() as Promise&#x3C;void>),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">catch: () => new Model.SendEmailError()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">}).pipe(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.andThen(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.forEach(requests, (request) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">Request.completeEffect(request, Effect.void)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.catchAll((error) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.forEach(requests, (request) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">Request.completeEffect(request, Effect.fail(error))</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">)</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="import { Effect, RequestResolver, Request } from &#x22;effect&#x22;import * as API from &#x22;./API&#x22;import * as Model from &#x22;./Model&#x22;import * as Requests from &#x22;./Requests&#x22;// GetTodosはバッチ処理できないと仮定し、標準的なリゾルバを作成します。export const GetTodosResolver = RequestResolver.fromEffect(  (request: Requests.GetTodos) => API.getTodos)// GetUserByIdはバッチ処理できると仮定し、バッチリゾルバを作成します。export const GetUserByIdResolver = RequestResolver.makeBatched(  (requests: ReadonlyArray<Requests.GetUserById>) =>    Effect.tryPromise({      try: () =>        fetch(&#x22;https://api.example.demo/getUserByIdBatch&#x22;, {          method: &#x22;POST&#x22;,          headers: {            &#x22;Content-Type&#x22;: &#x22;application/json&#x22;          },          body: JSON.stringify({            users: requests.map(({ id }) => ({ id }))          })        }).then((res) => res.json()) as Promise<Array<Model.User>>,      catch: () => new Model.GetUserError()    }).pipe(      Effect.andThen((users) =>        Effect.forEach(requests, (request, index) =>          Request.completeEffect(request, Effect.succeed(users[index]))        )      ),      Effect.catchAll((error) =>        Effect.forEach(requests, (request) =>          Request.completeEffect(request, Effect.fail(error))        )      )    ))// SendEmailはバッチ処理できると仮定し、バッチリゾルバを作成します。export const SendEmailResolver = RequestResolver.makeBatched(  (requests: ReadonlyArray<Requests.SendEmail>) =>    Effect.tryPromise({      try: () =>        fetch(&#x22;https://api.example.demo/sendEmailBatch&#x22;, {          method: &#x22;POST&#x22;,          headers: {            &#x22;Content-Type&#x22;: &#x22;application/json&#x22;          },          body: JSON.stringify({            emails: requests.map(({ address, text }) => ({ address, text }))          })        }).then((res) => res.json() as Promise<void>),      catch: () => new Model.SendEmailError()    }).pipe(      Effect.andThen(        Effect.forEach(requests, (request) =>          Request.completeEffect(request, Effect.void)        )      ),      Effect.catchAll((error) =>        Effect.forEach(requests, (request) =>          Request.completeEffect(request, Effect.fail(error))        )      )    ))"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Resolvers.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Resolvers</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: Resolvers.ts// ---cut---// @include: Resolvers"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <div>
                      <p>
                        リゾルバは他のすべての<code dir="auto">Effect</code
                        >と同様にコンテキストにアクセスすることができ、リゾルバを作成する方法は多種多様です。さらに詳しい情報は、<a
                          href="https://effect-ts.github.io/effect/effect/RequestResolver.ts.html"
                          >RequestResolver</a
                        >モジュールのリファレンス文書を参照してください。
                      </p>
                    </div>
                    <p>この構成では：</p>
                    <ul>
                      <li>
                        <strong>GetTodosResolver</strong>は複数の Todo
                        アイテムを取得する処理を担当します。バッチ処理ができないと仮定し、標準のリゾルバで設定されています。
                      </li>
                      <li>
                        <strong>GetUserByIdResolver</strong
                        >と<strong>SendEmailResolver</strong>はバッチリゾルバとして設定されています。これにより、これらのリクエストがバッチで処理できることでパフォーマンスが向上し、API
                        コールの数が減少します。
                      </li>
                    </ul>
                    <h3 id="クエリの定義">クエリの定義</h3>
                    <p>
                      リゾルバを設定したので、すべてのパーツを結びつけてクエリを定義する準備が整いました。このステップにより、アプリケーション内でデータ操作を効果的に行うことができます。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame not-content">
                        <figcaption class="header"></figcaption>
                        <pre
                          data-language="twoslash"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import { Effect } from "effect"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Model from "./Model"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Requests from "./Requests"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Resolvers from "./Resolvers"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// すべてのTodoアイテムを取得するクエリを定義します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const getTodos: Effect.Effect&#x3C;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">Array&#x3C;Model.Todo>,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">Model.GetTodosError</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">> = Effect.request(Requests.GetTodos({}), Resolvers.GetTodosResolver)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// IDを使用してユーザーを取得するクエリを定義します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const getUserById = (id: number) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.request(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Requests.GetUserById({ id }),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Resolvers.GetUserByIdResolver</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// 特定のアドレスにメールを送信するクエリを定義します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const sendEmail = (address: string, text: string) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.request(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Requests.SendEmail({ address, text }),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Resolvers.SendEmailResolver</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// getUserByIdとsendEmailを組み合わせて特定のユーザーにメールを送信します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const sendEmailToUser = (id: number, message: string) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">getUserById(id).pipe(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.andThen((user) => sendEmail(user.email, message))</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">// getUserByIdを使用してTODOの所有者を取得し、メール通知を送信します</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const notifyOwner = (todo: Model.Todo) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">getUserById(todo.ownerId).pipe(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.andThen((user) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">sendEmailToUser(user.id, `hey ${user.name} you got a todo!`)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="import { Effect } from &#x22;effect&#x22;import * as Model from &#x22;./Model&#x22;import * as Requests from &#x22;./Requests&#x22;import * as Resolvers from &#x22;./Resolvers&#x22;// すべてのTodoアイテムを取得するクエリを定義しますexport const getTodos: Effect.Effect<  Array<Model.Todo>,  Model.GetTodosError> = Effect.request(Requests.GetTodos({}), Resolvers.GetTodosResolver)// IDを使用してユーザーを取得するクエリを定義しますexport const getUserById = (id: number) =>  Effect.request(    Requests.GetUserById({ id }),    Resolvers.GetUserByIdResolver  )// 特定のアドレスにメールを送信するクエリを定義しますexport const sendEmail = (address: string, text: string) =>  Effect.request(    Requests.SendEmail({ address, text }),    Resolvers.SendEmailResolver  )// getUserByIdとsendEmailを組み合わせて特定のユーザーにメールを送信しますexport const sendEmailToUser = (id: number, message: string) =>  getUserById(id).pipe(    Effect.andThen((user) => sendEmail(user.email, message))  )// getUserByIdを使用してTODOの所有者を取得し、メール通知を送信しますexport const notifyOwner = (todo: Model.Todo) =>  getUserById(todo.ownerId).pipe(    Effect.andThen((user) =>      sendEmailToUser(user.id, &#x60;hey ${user.name} you got a todo!&#x60;)    )  )"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Resolvers.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Resolvers</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Queries.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Queries</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: Resolvers.ts// @include: Resolvers// @filename: Queries.ts// ---cut---// @include: Queries"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      <code dir="auto">Effect.request</code
                      >関数を使用することで、リゾルバとリクエストモデルを効果的に統合します。このアプローチにより、各クエリが最適に解決され、適切なリゾルバを使用できるようになります。
                    </p>
                    <p>
                      以前の例とコード構造は似ていますが、リゾルバを使用することで、リクエストの処理方法が最適化され、不要な
                      API コールが削減され、効率が大幅に向上します。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight mark"><div class="code"><span style="--0:#94a3a3;--1:#515767">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Resolvers.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Resolvers</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Queries.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Queries</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: index.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Queries </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Queries</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">gen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function* </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">todos</span><span style="--0:#C792EA;--1:#8D46B4"> = yield* </span><span style="--0:#D6DEEB;--1:#403F53">Queries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">getTodos</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">yield* </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">forEach</span><span style="--0:#D6DEEB;--1:#403F53">(todos</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">todo</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">Queries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">notifyOwner</span><span style="--0:#D6DEEB;--1:#403F53">(todo)</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">batching: </span><span style="--0:#FF5874;--1:#A54A4A">true</span><span style="--0:#7690A6;--1:#4F687D">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: Resolvers.ts// @include: Resolvers// @filename: Queries.ts// @include: Queries// @filename: index.ts// ---cut---import { Effect } from &#x22;effect&#x22;;import * as Queries from &#x22;./Queries&#x22;;const program = Effect.gen(function* () {  const todos = yield* Queries.getTodos;  yield* Effect.forEach(todos, (todo) => Queries.notifyOwner(todo), {    batching: true,  });});"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      この最終セットアップでは、このプログラムは TODO
                      の数に関係なく、API
                      に対して<strong>3</strong>つのクエリのみを実行します。従来のアプローチでは、<strong
                        >1 + 2n</strong
                      >クエリが実行される可能性があり、ここで<strong>n</strong>は
                      TODO
                      の数です。これは特にデータインタラクションの量が多いアプリケーションにとって、効率の大幅な改善を表しています。
                    </p>
                    <h3 id="バッチ処理の無効化">バッチ処理の無効化</h3>
                    <p>
                      バッチ処理は、<code dir="auto"
                        >Effect.withRequestBatching</code
                      >ユーティリティを使用して以下のようにローカルで無効化できます。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line highlight mark"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Resolvers.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Resolvers</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Queries.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Queries</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: index.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Queries </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Queries</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">gen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function* </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">todos</span><span style="--0:#C792EA;--1:#8D46B4"> = yield* </span><span style="--0:#D6DEEB;--1:#403F53">Queries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">getTodos</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">yield* </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">forEach</span><span style="--0:#D6DEEB;--1:#403F53">(todos</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">todo</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">Queries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">notifyOwner</span><span style="--0:#D6DEEB;--1:#403F53">(todo)</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">concurrency: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">unbounded</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#7690A6;--1:#4F687D">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">withRequestBatching</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#FF5874;--1:#A54A4A">false</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: Resolvers.ts// @include: Resolvers// @filename: Queries.ts// @include: Queries// @filename: index.ts// ---cut---import { Effect } from &#x22;effect&#x22;;import * as Queries from &#x22;./Queries&#x22;;const program = Effect.gen(function* () {  const todos = yield* Queries.getTodos;  yield* Effect.forEach(todos, (todo) => Queries.notifyOwner(todo), {    concurrency: &#x22;unbounded&#x22;,  });}).pipe(Effect.withRequestBatching(false));"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <h3 id="コンテキストを持つリゾルバ">
                      コンテキストを持つリゾルバ
                    </h3>
                    <p>
                      複雑なアプリケーションでは、リゾルバがリクエストを効果的に処理するために、共有サービスや設定にアクセスする必要がある場合がよくあります。しかし、バッチリクエストの処理能力を維持しながら必要なコンテキストを提供するのは困難です。ここでは、リゾルバにコンテキストを管理する方法を探ります。
                    </p>
                    <p>
                      リクエストリゾルバを作成する際には、コンテキストを慎重に管理することが重要です。リゾルバがバッチ処理に適合しないように過剰なコンテキストを提供することや、リゾルバにさまざまなサービスを提供することを避けるため、<code
                        dir="auto"
                        >Effect.request</code
                      >で使用されるリゾルバのコンテキストは明示的に<code
                        dir="auto"
                        >never</code
                      >に設定されます。これにより、開発者はリゾルバ内でコンテキストがどのようにアクセスされ、使用されるかを明確に定義する必要があります。
                    </p>
                    <p>
                      以下の例では、リゾルバが API
                      コールを実行するために使用できる HTTP
                      サービスを設定しています。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame not-content">
                        <figcaption class="header"></figcaption>
                        <pre
                          data-language="twoslash"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import { Effect, Context, RequestResolver } from "effect"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Model from "./Model"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">import * as Requests from "./Requests"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export class HttpService extends Context.Tag("HttpService")&#x3C;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">HttpService,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">{ fetch: typeof fetch }</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">>() {}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">export const GetTodosResolver =</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">// 以前と同様に通常のリゾルバを作成します</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">RequestResolver.fromEffect((request: Requests.GetTodos) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.andThen(HttpService, (http) =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">Effect.tryPromise({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">try: () =></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">          </span></span><span style="--0:#d6deeb;--1:#403f53">http</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">            </span></span><span style="--0:#d6deeb;--1:#403f53">.fetch("https://api.example.demo/todos")</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">            </span></span><span style="--0:#d6deeb;--1:#403f53">.then((res) => res.json() as Promise&#x3C;Array&#x3C;Model.Todo>>),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">        </span></span><span style="--0:#d6deeb;--1:#403f53">catch: () => new Model.GetTodosError()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">      </span></span><span style="--0:#d6deeb;--1:#403f53">})</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">).pipe(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">// リゾルバがアクセスできるタグをリストします</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">    </span></span><span style="--0:#d6deeb;--1:#403f53">RequestResolver.contextFromServices(HttpService)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#d6deeb;--1:#403f53">  </span></span><span style="--0:#d6deeb;--1:#403f53">)</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="import { Effect, Context, RequestResolver } from &#x22;effect&#x22;import * as Model from &#x22;./Model&#x22;import * as Requests from &#x22;./Requests&#x22;export class HttpService extends Context.Tag(&#x22;HttpService&#x22;)<  HttpService,  { fetch: typeof fetch }>() {}export const GetTodosResolver =  // 以前と同様に通常のリゾルバを作成します  RequestResolver.fromEffect((request: Requests.GetTodos) =>    Effect.andThen(HttpService, (http) =>      Effect.tryPromise({        try: () =>          http            .fetch(&#x22;https://api.example.demo/todos&#x22;)            .then((res) => res.json() as Promise<Array<Model.Todo>>),        catch: () => new Model.GetTodosError()      })    )  ).pipe(    // リゾルバがアクセスできるタグをリストします    RequestResolver.contextFromServices(HttpService)  )"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: ResolversWithContext.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: ResolversWithContext</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: ResolversWithContext.ts// ---cut---// @include: ResolversWithContext"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      ここで、<code dir="auto">GetTodosResolver</code
                      >のタイプはもはや<code dir="auto">RequestResolver</code
                      >ではなく、次のようになります：
                    </p>
                    <div class="expressive-code">
                      <figure class="frame not-content">
                        <figcaption class="header"></figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53">RequestResolver</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53">GetTodos, never</span><span style="--0:#C792EA;--1:#8D46B4">></span><span style="--0:#D6DEEB;--1:#403F53">, never, HttpService</span><span style="--0:#C792EA;--1:#8D46B4">></span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="Effect<RequestResolver<GetTodos, never>, never, HttpService>;"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      これは、<code dir="auto">HttpService</code
                      >にアクセスし、使用準備が整った最小限のコンテキストを持つ組み込みリゾルバを返す<code
                        dir="auto"
                        >Effect</code
                      >です。
                    </p>
                    <p>
                      このような<code dir="auto">Effect</code
                      >が得られた後、クエリの定義内で直接利用できます。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: ResolversWithContext.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: ResolversWithContext</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: QueriesWithContext.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Model </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Model</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Requests </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Requests</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> ResolversWithContext </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./ResolversWithContext</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export const </span><span style="--0:#82AAFF;--1:#3C63B3">getTodos</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">request</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Requests</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">GetTodos</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">{}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">ResolversWithContext</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">GetTodosResolver</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: ResolversWithContext.ts// @include: ResolversWithContext// @filename: QueriesWithContext.ts// ---cut---import { Effect } from &#x22;effect&#x22;;import * as Model from &#x22;./Model&#x22;;import * as Requests from &#x22;./Requests&#x22;;import * as ResolversWithContext from &#x22;./ResolversWithContext&#x22;;export const getTodos = Effect.request(  Requests.GetTodos({}),  ResolversWithContext.GetTodosResolver);"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      この Effect が正しく<code dir="auto">HttpService</code
                      >の提供を要求しているのがわかります。
                    </p>
                    <p>
                      別の方法として、アクションを生成する際にコンテキストを直接アクセスまたはクローズオーバーしてリゾルバを作成することもできます。
                    </p>
                    <p>例えば：</p>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: ResolversWithContext.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: ResolversWithContext</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: QueriesFromLayers.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect, Context, Layer, RequestResolver } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> API </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./API</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Model </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Model</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Requests </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Requests</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> ResolversWithContext </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./ResolversWithContext</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">class</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">TodosService</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">extends</span><span style="--0:#D6DEEB;--1:#403F53"> Context</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">Tag</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">TodosService</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">)&#x3C;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FFCB8B;--1:#111111">TodosService</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">getTodos</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7690A6;--1:#4F687D">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">Effect</span><span style="--0:#D6DEEB;--1:#403F53">&#x3C;</span><span style="--0:#FFCB8B;--1:#111111">Array</span><span style="--0:#D6DEEB;--1:#403F53">&#x3C;</span><span style="--0:#7690A6;--1:#4F687D">Model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">Todo</span><span style="--0:#D6DEEB;--1:#403F53">>, </span><span style="--0:#7690A6;--1:#4F687D">Model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">GetTodosError</span><span style="--0:#D6DEEB;--1:#403F53">>;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">>() {}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export const </span><span style="--0:#82AAFF;--1:#3C63B3">TodosServiceLive</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Layer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">effect</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">TodosService</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">gen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function* </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">http</span><span style="--0:#C792EA;--1:#8D46B4"> = yield* </span><span style="--0:#D6DEEB;--1:#403F53">ResolversWithContext</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">HttpService</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">resolver</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">RequestResolver</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fromEffect</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">request</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> Requests.</span><span style="--1:#111111"><span style="--0:#FFCB8B">GetTodos</span><span style="--0:#D9F5DD">)</span></span><span style="--0:#C792EA;--1:#8D46B4"> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">tryPromise</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#FFCB8B;--1:#111111">Array</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#7690A6;--1:#4F687D">Model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">Todo</span><span style="--0:#C792EA;--1:#8D46B4">></span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#7690A6;--1:#4F687D">Model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">GetTodosError</span><span style="--0:#C792EA;--1:#8D46B4">></span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">try</span><span style="--0:#C792EA;--1:#8D46B4">: </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#D6DEEB;--1:#403F53">http</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">            </span></span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fetch</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">https://api.example.demo/todos</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">            </span></span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">res</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">res</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">json</span><span style="--0:#D6DEEB;--1:#403F53">())</span><span style="--0:#7690A6;--1:#4F687D">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3C63B3">catch</span><span style="--0:#C792EA;--1:#8D46B4">: </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#7FDBCA;--1:#097174">new</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#D6DEEB;--1:#403F53">Model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">GetTodosError</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#7690A6;--1:#4F687D">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">      </span></span><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">return {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">      </span></span><span style="--0:#C792EA;--1:#8D46B4">getTodos: </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">request</span><span style="--0:#D6DEEB;--1:#403F53">(Requests</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">GetTodos</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">{}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#D6DEEB;--1:#403F53">resolver)</span><span style="--0:#7690A6;--1:#4F687D">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">};</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export const </span><span style="--0:#82AAFF;--1:#3C63B3">getTodos</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> Effect.</span><span style="--0:#FFCB8B;--1:#111111">Effect</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FFCB8B;--1:#111111">Array</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#7690A6;--1:#4F687D">Model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">Todo</span><span style="--0:#C792EA;--1:#8D46B4">>,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7690A6;--1:#4F687D">Model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">GetTodosError</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FFCB8B;--1:#111111">TodosService</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">andThen</span><span style="--0:#D6DEEB;--1:#403F53">(TodosService</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">service</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">service</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">getTodos</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: ResolversWithContext.ts// @include: ResolversWithContext// @filename: QueriesFromLayers.ts// ---cut---import { Effect, Context, Layer, RequestResolver } from &#x22;effect&#x22;;import * as API from &#x22;./API&#x22;;import * as Model from &#x22;./Model&#x22;;import * as Requests from &#x22;./Requests&#x22;;import * as ResolversWithContext from &#x22;./ResolversWithContext&#x22;;export class TodosService extends Context.Tag(&#x22;TodosService&#x22;)<  TodosService,  {    getTodos: Effect.Effect<Array<Model.Todo>, Model.GetTodosError>;  }>() {}export const TodosServiceLive = Layer.effect(  TodosService,  Effect.gen(function* () {    const http = yield* ResolversWithContext.HttpService;    const resolver = RequestResolver.fromEffect((request: Requests.GetTodos) =>      Effect.tryPromise<Array<Model.Todo>, Model.GetTodosError>({        try: () =>          http            .fetch(&#x22;https://api.example.demo/todos&#x22;)            .then((res) => res.json()),        catch: () => new Model.GetTodosError(),      })    );    return {      getTodos: Effect.request(Requests.GetTodos({}), resolver),    };  }));export const getTodos: Effect.Effect<  Array<Model.Todo>,  Model.GetTodosError,  TodosService> = Effect.andThen(TodosService, (service) => service.getTodos);"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      この方法は、サービスを結びつけるための自然なプリミティブであるため、ほとんどのケースには最適です。
                    </p>
                    <h2 id="キャッシング">キャッシング</h2>
                    <p>
                      リクエストのバッチ処理を大幅に最適化した一方で、アプリケーションの効率を向上させる別の領域があります。それはキャッシングです。キャッシングがない場合、最適化されたバッチ処理であっても、同じリクエストが複数回実行されることになり、不必要なデータ取得を引き起こします。
                    </p>
                    <p>
                      Effect
                      ライブラリでは、キャッシングは組み込みユーティリティを通じて管理され、リクエストが一時的に保存され、変更されていないデータを再取得する必要がなくなります。この機能は、特に頻繁に類似のリクエストを行うアプリケーションでは、サーバーとネットワークの負荷を削減するために重要です。
                    </p>
                    <p>
                      <code dir="auto">getUserById</code
                      >クエリにキャッシングを実装する方法は以下の通りです。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line highlight mark"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Resolvers.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Resolvers</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Queries.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Requests </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Requests</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Resolvers </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Resolvers</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export const </span><span style="--0:#82AAFF;--1:#3C63B3">getUserById</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">id</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">request</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">Requests</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">GetUserById</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">{ </span><span style="--0:#D6DEEB;--1:#403F53">id</span><span style="--0:#C792EA;--1:#8D46B4"> }</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">Resolvers</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">GetUserByIdResolver</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">withRequestCaching</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#FF5874;--1:#A54A4A">true</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: Resolvers.ts// @include: Resolvers// @filename: Queries.ts// ---cut---import { Effect } from &#x22;effect&#x22;;import * as Requests from &#x22;./Requests&#x22;;import * as Resolvers from &#x22;./Resolvers&#x22;;export const getUserById = (id: number) =>  Effect.request(    Requests.GetUserById({ id }),    Resolvers.GetUserByIdResolver  ).pipe(Effect.withRequestCaching(true));"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <h2 id="最終プログラム">最終プログラム</h2>
                    <p>すべてが正しく接続されていると仮定すると：</p>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Resolvers.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Resolvers</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Queries.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Queries</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: index.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect, Schedule } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Queries </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Queries</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">gen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function* </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">todos</span><span style="--0:#C792EA;--1:#8D46B4"> = yield* </span><span style="--0:#D6DEEB;--1:#403F53">Queries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">getTodos</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">yield* </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">forEach</span><span style="--0:#D6DEEB;--1:#403F53">(todos</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">todo</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">Queries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">notifyOwner</span><span style="--0:#D6DEEB;--1:#403F53">(todo)</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">concurrency: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">unbounded</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#7690A6;--1:#4F687D">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">repeat</span><span style="--0:#D6DEEB;--1:#403F53">(Schedule</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fixed</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">10 seconds</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">)));</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: Resolvers.ts// @include: Resolvers// @filename: Queries.ts// @include: Queries// @filename: index.ts// ---cut---import { Effect, Schedule } from &#x22;effect&#x22;;import * as Queries from &#x22;./Queries&#x22;;const program = Effect.gen(function* () {  const todos = yield* Queries.getTodos;  yield* Effect.forEach(todos, (todo) => Queries.notifyOwner(todo), {    concurrency: &#x22;unbounded&#x22;,  });}).pipe(Effect.repeat(Schedule.fixed(&#x22;10 seconds&#x22;)));"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <p>
                      このプログラムでは、<code dir="auto">getTodos</code
                      >操作が各ユーザーの TODO を取得します。その後、<code
                        dir="auto"
                        >Effect.forEach</code
                      >関数を使用して、所有者に通知を送信し、その完了を待たずに並行して処理します。
                    </p>
                    <p>
                      <code dir="auto">repeat</code
                      >関数は、すべてのオペレーションチェーンに適用され、プログラムが固定スケジュールで
                      10 秒ごとに繰り返されることを保証します。これは、TODO
                      を取得し、通知を送信するプロセス全体が 10
                      秒間隔で繰り返されることを意味します。
                    </p>
                    <p>
                      プログラムはキャッシングメカニズムを組み込んでおり、これにより同じ<code
                        dir="auto"
                        >GetUserById</code
                      >操作が 1 分間に 1
                      回以上実行されることがありません。デフォルトのキャッシング動作は、プログラムの実行を最適化し、ユーザーデータの不必要なリクエストを削減するのに役立ちます。
                    </p>
                    <p>
                      さらに、プログラムはメールをバッチ処理するように設計されており、効率的な処理とリソースの適切な利用を実現しています。
                    </p>
                    <h2 id="リクエストキャッシングのカスタマイズ">
                      リクエストキャッシングのカスタマイズ
                    </h2>
                    <p>
                      実際のアプリケーションでは、効果的なキャッシング戦略が冗長なデータ取得を減らすことにより、パフォーマンスを大幅に向上させることができます。Effect
                      ライブラリは、アプリケーションの特定の部分またはグローバルに適用できる柔軟なキャッシングメカニズムを提供します。
                    </p>
                    <p>
                      アプリケーションの異なる部分がユニークなキャッシング要件を持つシナリオがあり得ます。いくつかはローカルキャッシュから利益を得るかもしれませんが、他のものはグローバルキャッシュの設定が必要な場合があります。それでは、特定のニーズに合わせてカスタムキャッシュを設定する方法を探ります。
                    </p>
                    <h3 id="カスタムキャッシュの作成">
                      カスタムキャッシュの作成
                    </h3>
                    <p>
                      カスタムキャッシュを作成し、アプリケーションの一部に適用する方法は以下の通りです。この例では、特定のパラメータ（キャパシティと
                      TTL（生存時間））でリクエストをキャッシュするタスクを 10
                      秒ごとに繰り返すキャッシュを設定します。
                    </p>
                    <div class="expressive-code">
                      <figure class="frame has-title not-content">
                        <figcaption class="header">
                          <span class="title">Model.ts</span>
                        </figcaption>
                        <pre
                          data-language="ts"
                        ><code><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Model</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: API.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: API</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Requests.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Requests</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Resolvers.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Resolvers</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: Queries.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @include: Queries</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// @filename: index.ts</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect, Schedule, Layer, Request } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">*</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Queries </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">./Queries</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">gen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function* </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">todos</span><span style="--0:#C792EA;--1:#8D46B4"> = yield* </span><span style="--0:#D6DEEB;--1:#403F53">Queries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">getTodos</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">yield* </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">forEach</span><span style="--0:#D6DEEB;--1:#403F53">(todos</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">todo</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">Queries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">notifyOwner</span><span style="--0:#D6DEEB;--1:#403F53">(todo)</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">    </span></span><span style="--0:#C792EA;--1:#8D46B4">concurrency: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">unbounded</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#7690A6;--1:#4F687D">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8D46B4">  </span></span><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">}</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">repeat</span><span style="--0:#D6DEEB;--1:#403F53">(Schedule</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fixed</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">10 seconds</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">))</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">provide</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">Layer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">setRequestCache</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#D6DEEB;--1:#403F53">Request</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">makeCache</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">{ capacity: </span><span style="--0:#F78C6C;--1:#AA0982">256</span><span style="--0:#C792EA;--1:#8D46B4">, timeToLive: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">60 minutes</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8D46B4"> }</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre>
                        <div class="copy">
                          <button
                            title="Copy to clipboard"
                            data-copied="Copied!"
                            data-code="// @include: Model// @filename: API.ts// @include: API// @filename: Requests.ts// @include: Requests// @filename: Resolvers.ts// @include: Resolvers// @filename: Queries.ts// @include: Queries// @filename: index.ts// ---cut---import { Effect, Schedule, Layer, Request } from &#x22;effect&#x22;;import * as Queries from &#x22;./Queries&#x22;;const program = Effect.gen(function* () {  const todos = yield* Queries.getTodos;  yield* Effect.forEach(todos, (todo) => Queries.notifyOwner(todo), {    concurrency: &#x22;unbounded&#x22;,  });}).pipe(  Effect.repeat(Schedule.fixed(&#x22;10 seconds&#x22;)),  Effect.provide(    Layer.setRequestCache(      Request.makeCache({ capacity: 256, timeToLive: &#x22;60 minutes&#x22; })    )  ));"
                          >
                            <div></div>
                          </button>
                        </div>
                      </figure>
                    </div>
                    <h3 id="キャッシュの直接適用">キャッシュの直接適用</h3>
                    <p>
                      <code dir="auto">Request.makeCache</code
                      >を使用してキャッシュを構築し、それを特定のプログラムに直接適用することもできます。この方法では、指定されたプログラムから発生するすべてのリクエストがカスタムキャッシュを通じて管理されることが保証されます。キャッシングが有効な場合に限ります。
                    </p>
                  </div>
                  <footer class="sl-flex astro-gcr56zec">
                    <div class="meta sl-flex astro-gcr56zec"></div>
                    <div class="pagination-links astro-qepcwt4y" dir="ltr">
                      <a
                        href="/guides/state-management/200-synchronizedrefmdx_ja/"
                        rel="prev"
                        class="astro-qepcwt4y"
                      >
                        <svg
                          aria-hidden="true"
                          class="astro-qepcwt4y astro-mzbodlcp"
                          width="16"
                          height="16"
                          viewBox="0 0 24 24"
                          fill="currentColor"
                          style="--sl-icon-size: 1.5rem"
                        >
                          <path
                            d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"
                          />
                        </svg>
                        <span class="astro-qepcwt4y">
                          Previous <br class="astro-qepcwt4y" />
                          <span class="link-title astro-qepcwt4y"
                            >SynchronizedRef</span
                          >
                        </span>
                      </a>
                      <a
                        href="/guides/caching/"
                        rel="next"
                        class="astro-qepcwt4y"
                      >
                        <svg
                          aria-hidden="true"
                          class="astro-qepcwt4y astro-mzbodlcp"
                          width="16"
                          height="16"
                          viewBox="0 0 24 24"
                          fill="currentColor"
                          style="--sl-icon-size: 1.5rem"
                        >
                          <path
                            d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"
                          />
                        </svg>
                        <span class="astro-qepcwt4y">
                          Next <br class="astro-qepcwt4y" />
                          <span class="link-title astro-qepcwt4y">Caching</span>
                        </span>
                      </a>
                    </div>
                  </footer>
                </div>
              </div>
            </main>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
