<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-ds2wt7hw"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>パイプラインの構築 | Effect日本語版ドキュメント</title><link rel="canonical"/><link rel="shortcut icon" href="/icon.png" type="image/png"/><meta name="generator" content="Astro v4.14.5"/><meta name="generator" content="Starlight v0.26.1"/><meta property="og:title" content="パイプラインの構築"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description"/><meta property="og:site_name" content="Effect日本語版ドキュメント"/><meta name="twitter:card" content="summary_large_image"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/_astro/index.C-KpjUOJ.css">
<style>:root{--sl-badge-default-border: var(--sl-color-accent);--sl-badge-default-bg: var(--sl-color-accent-low);--sl-badge-default-text: #fff;--sl-badge-note-border: var(--sl-color-blue);--sl-badge-note-bg: var(--sl-color-blue-low);--sl-badge-note-text: #fff;--sl-badge-danger-border: var(--sl-color-red);--sl-badge-danger-bg: var(--sl-color-red-low);--sl-badge-danger-text: #fff;--sl-badge-success-border: var(--sl-color-green);--sl-badge-success-bg: var(--sl-color-green-low);--sl-badge-success-text: #fff;--sl-badge-caution-border: var(--sl-color-orange);--sl-badge-caution-bg: var(--sl-color-orange-low);--sl-badge-caution-text: #fff;--sl-badge-tip-border: var(--sl-color-purple);--sl-badge-tip-bg: var(--sl-color-purple-low);--sl-badge-tip-text: #fff}[data-theme=light]:root{--sl-badge-default-bg: var(--sl-color-accent-high);--sl-badge-note-bg: var(--sl-color-blue-high);--sl-badge-danger-bg: var(--sl-color-red-high);--sl-badge-success-bg: var(--sl-color-green-high);--sl-badge-caution-bg: var(--sl-color-orange-high);--sl-badge-tip-bg: var(--sl-color-purple-high)}.sl-badge:where(.astro-x444flib){display:inline-block;border:1px solid var(--sl-color-border-badge);border-radius:.25rem;font-family:var(--sl-font-system-mono);line-height:normal;color:var(--sl-color-text-badge);background-color:var(--sl-color-bg-badge);overflow-wrap:anywhere}.sidebar-content .sl-badge:where(.astro-x444flib){line-height:1;font-size:var(--sl-text-xs);padding:.125rem .375rem}.sidebar-content a[aria-current=page]>.sl-badge:where(.astro-x444flib){--sl-color-bg-badge: transparent;--sl-color-border-badge: currentColor;color:inherit}.default:where(.astro-x444flib){--sl-color-bg-badge: var(--sl-badge-default-bg);--sl-color-border-badge: var(--sl-badge-default-border);--sl-color-text-badge: var(--sl-badge-default-text)}.note:where(.astro-x444flib){--sl-color-bg-badge: var(--sl-badge-note-bg);--sl-color-border-badge: var(--sl-badge-note-border);--sl-color-text-badge: var(--sl-badge-note-text)}.danger:where(.astro-x444flib){--sl-color-bg-badge: var(--sl-badge-danger-bg);--sl-color-border-badge: var(--sl-badge-danger-border);--sl-color-text-badge: var(--sl-badge-danger-text)}.success:where(.astro-x444flib){--sl-color-bg-badge: var(--sl-badge-success-bg);--sl-color-border-badge: var(--sl-badge-success-border);--sl-color-text-badge: var(--sl-badge-success-text)}.tip:where(.astro-x444flib){--sl-color-bg-badge: var(--sl-badge-tip-bg);--sl-color-border-badge: var(--sl-badge-tip-border);--sl-color-text-badge: var(--sl-badge-tip-text)}.caution:where(.astro-x444flib){--sl-color-bg-badge: var(--sl-badge-caution-bg);--sl-color-border-badge: var(--sl-badge-caution-border);--sl-color-text-badge: var(--sl-badge-caution-text)}.small:where(.astro-x444flib){font-size:var(--sl-text-xs);padding:.125rem .25rem}.medium:where(.astro-x444flib){font-size:var(--sl-text-sm);padding:.175rem .35rem}.large:where(.astro-x444flib){font-size:var(--sl-text-base);padding:.225rem .45rem}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6) .sl-badge:where(.astro-x444flib){vertical-align:middle}
svg:where(.astro-mzbodlcp){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}
starlight-tabs:where(.astro-oy26qiqb){display:block}.tablist-wrapper:where(.astro-oy26qiqb){overflow-x:auto}:where(.astro-oy26qiqb)[role=tablist]{display:flex;list-style:none;border-bottom:2px solid var(--sl-color-gray-5);padding:0}.tab:where(.astro-oy26qiqb){margin-bottom:-2px}.tab:where(.astro-oy26qiqb)>:where(.astro-oy26qiqb)[role=tab]{display:flex;align-items:center;gap:.5rem;padding:0 1.25rem;text-decoration:none;border-bottom:2px solid var(--sl-color-gray-5);color:var(--sl-color-gray-3);outline-offset:var(--sl-outline-offset-inside);overflow-wrap:initial}.tab:where(.astro-oy26qiqb) :where(.astro-oy26qiqb)[role=tab][aria-selected=true]{color:var(--sl-color-white);border-color:var(--sl-color-text-accent);font-weight:600}.tablist-wrapper:where(.astro-oy26qiqb)~[role=tabpanel]{margin-top:1rem}
.sl-steps{--bullet-size: calc(var(--sl-line-height) * 1rem);--bullet-margin: .375rem;list-style:none;counter-reset:steps-counter var(--sl-steps-start, 0);padding-inline-start:0}.sl-steps>li{counter-increment:steps-counter;position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(steps-counter);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:var(--sl-text-xs);font-weight:600;text-align:center;color:var(--sl-color-white);background-color:var(--sl-color-gray-6);border-radius:99rem;box-shadow:inset 0 0 0 1px var(--sl-color-gray-5)}.sl-steps>li:after{--guide-width: 1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width)) / 2);width:var(--guide-width);background-color:var(--sl-color-hairline-light)}.sl-steps>li>:first-child{--lh: calc(1em * var(--sl-line-height));--shift-y: calc(.5 * (var(--bullet-size) - var(--lh)));transform:translateY(var(--shift-y));margin-bottom:var(--shift-y)}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh: calc(1em * var(--sl-line-height-headings))}@supports (--prop: 1lh){.sl-steps>li>:first-child{--lh: 1lh}}
.sl-link-button:where(.astro-6gpctszv){align-items:center;border:1px solid transparent;border-radius:999rem;display:inline-flex;font-size:var(--sl-text-sm);gap:.5em;line-height:1.1875;outline-offset:.25rem;padding:.4375rem 1.125rem;text-decoration:none}.sl-link-button:where(.astro-6gpctszv).primary{background:var(--sl-color-text-accent);border-color:var(--sl-color-text-accent);color:var(--sl-color-black)}.sl-link-button:where(.astro-6gpctszv).primary:hover{color:var(--sl-color-black)}.sl-link-button:where(.astro-6gpctszv).secondary{border-color:inherit;color:var(--sl-color-white)}.sl-link-button:where(.astro-6gpctszv).minimal{color:var(--sl-color-white);padding-inline:0}.sl-link-button:where(.astro-6gpctszv) svg{flex-shrink:0}@media (min-width: 50rem){.sl-link-button:where(.astro-6gpctszv){font-size:var(--sl-text-base);padding:.9375rem 1.25rem}}.sl-markdown-content .sl-link-button:where(.astro-6gpctszv){margin-inline-end:1rem}.sl-markdown-content .sl-link-button:where(.astro-6gpctszv):not(:where(p *)){margin-block:1rem}
</style><script type="module" src="/_astro/hoisted.FicniJ2Z.js"></script>
<script type="module" src="/_astro/page.LS5KDvwX.js"></script></head> <body class="astro-ds2wt7hw"> <a href="#_top" class="astro-4zievzub">Skip to content</a>  <div class="page sl-flex astro-444rl2wv"> <header class="header astro-444rl2wv"><div class="header sl-flex astro-y4sn2rzm"> <div class="title-wrapper sl-flex astro-y4sn2rzm"> <a href="/" class="site-title sl-flex astro-674d5lyb">  <span class="astro-674d5lyb"> Effect日本語版ドキュメント </span> </a>  </div> <div class="sl-flex astro-y4sn2rzm"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-vplcdv4k"> <button data-open-modal disabled aria-label="Search" aria-keyshortcuts="Control+K" class="astro-vplcdv4k"> <svg aria-hidden="true" class="astro-vplcdv4k astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-vplcdv4k" aria-hidden="true">Search</span> <kbd class="sl-hidden md:sl-flex astro-vplcdv4k" style="display: none;"> <kbd class="astro-vplcdv4k">Ctrl</kbd><kbd class="astro-vplcdv4k">K</kbd> </kbd> </button> <dialog style="padding:0" aria-label="Search" class="astro-vplcdv4k"> <div class="dialog-frame sl-flex astro-vplcdv4k">  <button data-close-modal class="sl-flex md:sl-hidden astro-vplcdv4k"> Cancel </button> <div class="search-container astro-vplcdv4k"> <div id="starlight__search" class="astro-vplcdv4k"></div> </div> </div> </dialog> </site-search>  <script>
	(() => {
		const openBtn = document.querySelector('button[data-open-modal]');
		const shortcut = openBtn?.querySelector('kbd');
		if (!openBtn || !(shortcut instanceof HTMLElement)) return;
		const platformKey = shortcut.querySelector('kbd');
		if (platformKey && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)) {
			platformKey.textContent = '⌘';
			openBtn.setAttribute('aria-keyshortcuts', 'Meta+K');
		}
		shortcut.style.display = '';
	})();
</script>    </div> <div class="sl-hidden md:sl-flex right-group astro-y4sn2rzm"> <div class="sl-flex social-icons astro-y4sn2rzm"> <a href="https://github.com/withastro/starlight" rel="me" class="sl-flex astro-a5kxgq6d"><span class="sr-only astro-a5kxgq6d">GitHub</span><svg aria-hidden="true" class="astro-a5kxgq6d astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-6mzzj2bg"> <span class="sr-only astro-6mzzj2bg">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-6mzzj2bg astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-6mzzj2bg"> <option value="dark" class="astro-6mzzj2bg">Dark</option><option value="light" class="astro-6mzzj2bg">Light</option><option value="auto" selected="true" class="astro-6mzzj2bg">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-6mzzj2bg astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-444rl2wv" aria-label="Main"> <starlight-menu-button class="astro-tzz67r6l"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-tzz67r6l"> <svg aria-hidden="true" class="astro-tzz67r6l astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-444rl2wv"> <div class="sidebar-content sl-flex astro-444rl2wv"> <sl-sidebar-state-persist data-hash="01kof5i" class="astro-epwuevht"> <ul class="top-level astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Introduction</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/introduction/101-introduction_jp/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectへようこそ</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/introduction/201-why-effect_jp/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">なぜEffectなのか？</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/introduction/300-quickstart_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">クイックスタート</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Guides</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Effect Essentials</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/effect-essentials/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effect Essentials</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/effect-essentials/100-importing-effect/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectのインポート</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/effect-essentials/200-the-effect-type_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effect型</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/effect-essentials/300-creating-effects_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectの作成</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/effect-essentials/400-running-effects_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectの実行</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/effect-essentials/500-using-generators_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectにおけるジェネレーターの使用</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/effect-essentials/600-pipeline_ja/" aria-current="page" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">パイプラインの構築</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Error Management</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/error-management/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Error Management</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/100-two-error-typesmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">二種類のエラー</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/1000-error-channel-operationsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">エラーチャンネル操作</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/1100-sequential-and-parallel-errorsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">並行および逐次エラー</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/1200-yieldable-errorsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Yield可能なエラー</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/200-expected-errorsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">予期されるエラー</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/300-unexpected-errorsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">予期しないエラー</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/400-fallbackmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">フォールバック</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/500-matchingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">マッチング</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/600-retryingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">再試行</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/700-timing-outmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">タイムアウト</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/800-sandboxingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">サンドボックス化</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/error-management/900-error-accumulationmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">エラーの蓄積</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Resource Management</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/resource-management/100-scopemdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">スコープ</span>  </a> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">patterns</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/resource-management/patterns/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Patterns</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/resource-management/patterns/100-sequence-of-operations-with-compensating-actions-on-failuremdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">失敗時の補償アクションを伴う操作のシーケンス</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <a href="/guides/resource-management/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Resource Management</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Requirements Management</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/requirements-management/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Requirements Management</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/requirements-management/100-servicesmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">サービスの管理</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/requirements-management/200-default-servicesmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">デフォルトサービス</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/requirements-management/300-layersmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">レイヤーの管理</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/requirements-management/400-dependency-memoizationmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">レイヤーのメモ化</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Observability</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/observability/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Observability</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/observability/100-loggingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">ロギング</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/observability/200-supervisormdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Supervisor</span>  </a> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Telemetry</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/observability/telemetry/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Telemetry</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/observability/telemetry/100-intromdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectにおけるテレメトリの紹介</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/observability/telemetry/200-metricsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectにおけるメトリクスの導入</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/observability/telemetry/300-tracingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectにおけるトレーシングの導入</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <a href="/guides/configuration/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Configuration</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/500-runtimemdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">実行時システムの紹介(Introduction to Runtime)</span>  </a> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Sceduling</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/sceduling/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Scheduling</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/sceduling/100-introductionmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">スケジューリングの紹介</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/sceduling/200-repetitionmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">繰り返し</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/sceduling/300-built-in-schedulesmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">組み込みスケジュール</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/sceduling/400-schedule-combinatorsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">スケジュール・コンビネータ</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/sceduling/500-examplesmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">例</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">State Management</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/state-management/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">State Management</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/state-management/100-refmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Ref</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/state-management/200-synchronizedrefmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">SynchronizedRef</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <a href="/guides/620-batching-cachingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Batching</span>  </a> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Caching</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/caching/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Caching</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/caching/100-effect-cachingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">キャッシングエフェクト</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/caching/200-cachemdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">キャッシュ</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Concurrency</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/concurrency/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Concurrency</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/concurrency/100-concurrency-optionsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">同時実行オプション</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/concurrency/110-fibersmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Fibers</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/concurrency/120-interruption-modelmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectの障害モデル入門</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/concurrency/130-deferredmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Deferred</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/concurrency/140-queuemdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">キュー</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/concurrency/150-pubsubmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">PubSub</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/concurrency/160-semaphoremdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">セマフォ</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/concurrency/50-basic-concurrencymdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">基本的な並行処理</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Streaming</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/streaming/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Streaming</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/300-subscriptionrefmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">SubscriptionRef</span>  </a> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Stream</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/streaming/stream/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Streams</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/stream/100-introductionmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">ストリーム入門</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/stream/200-creatingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">ストリームの作成</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/stream/300-resourceful-streamsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">リソースフルなストリーム</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/stream/400-operations/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Operations</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/stream/500-consuming-streamsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">ストリームの消費</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/stream/600-error-handlingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">ストリームにおけるエラー処理</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/stream/700-schedulingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">ストリームのスケジューリング</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Sink</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/streaming/sink/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Sinks</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/sink/100-introductionmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Sinksの紹介</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/sink/200-creatingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Sinksの作成</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/sink/300-operationsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Sink Operations</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/sink/400-parallel-operatorsmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">並行演算子</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/streaming/sink/500-leftoversmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Leftovers</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Testing</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/testing/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Testing</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/testing/100-testclockmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">TestClock</span>  </a> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <a href="/guides/700-control-flowmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Effectの制御フロー演算子入門</span>  </a> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Code Style</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4"> <li class="astro-tkdbfgf4"> <a href="/guides/code-style/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">Code Style</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/code-style/100-dualmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">デュアルAPI</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/code-style/200-branded-typesmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">ブランド型</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/code-style/300-pattern-matchingmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">パターンマッチング</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/code-style/400-domdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">過剰なネストを簡素化する</span>  </a> </li><li class="astro-tkdbfgf4"> <a href="/guides/code-style/500-guidelinesmdx_ja/" class="astro-tkdbfgf4"> <span class="astro-tkdbfgf4">ガイドライン</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-tkdbfgf4"> <details open class="astro-tkdbfgf4"> <summary class="astro-tkdbfgf4"> <div class="group-label astro-tkdbfgf4"> <span class="large astro-tkdbfgf4">Blog</span>  </div> <svg aria-hidden="true" class="caret astro-tkdbfgf4 astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-tkdbfgf4">  </ul>  </details> </li> </ul>  </sl-sidebar-state-persist> <div class="md:sl-hidden astro-epwuevht"> <div class="mobile-preferences sl-flex astro-misogbc3"> <div class="sl-flex social-icons astro-misogbc3"> <a href="https://github.com/withastro/starlight" rel="me" class="sl-flex astro-a5kxgq6d"><span class="sr-only astro-a5kxgq6d">GitHub</span><svg aria-hidden="true" class="astro-a5kxgq6d astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-6mzzj2bg"> <span class="sr-only astro-6mzzj2bg">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-6mzzj2bg astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-6mzzj2bg"> <option value="dark" class="astro-6mzzj2bg">Dark</option><option value="light" class="astro-6mzzj2bg">Light</option><option value="auto" selected="true" class="astro-6mzzj2bg">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-6mzzj2bg astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div>  <script>
	(() => {
		try {
			if (!matchMedia('(min-width: 50em)').matches) return;
			const scroller = document.getElementById('starlight__sidebar');
			/** @type {HTMLElement | null} */
			const target = document.querySelector('sl-sidebar-state-persist');
			const state = JSON.parse(sessionStorage.getItem('sl-sidebar-state') || '0');
			if (!scroller || !target || !state || target.dataset.hash !== state.hash) return;
			target
				.querySelectorAll('details')
				.forEach((el, idx) => typeof state.open[idx] === 'boolean' && (el.open = state.open[idx]));
			scroller.scrollTop = state.scroll;
		} catch {}
	})();
</script>  </div> </div> </nav> <div class="main-frame astro-444rl2wv">   <div class="lg:sl-flex astro-iia7liwg"> <aside class="right-sidebar-container astro-iia7liwg"> <div class="right-sidebar astro-iia7liwg"> <div class="lg:sl-hidden astro-mgyjzhcd"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-i5ioxqqj"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-i5ioxqqj"><details id="starlight__mobile-toc" class="astro-i5ioxqqj"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-i5ioxqqj"><div class="toggle sl-flex astro-i5ioxqqj">On this page<svg aria-hidden="true" class="caret astro-i5ioxqqj astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-i5ioxqqj"></span></summary><div class="dropdown astro-i5ioxqqj"><ul class="isMobile astro-wbc2ynvf" style="--depth: 0;"> <li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#_top" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#パイプラインがアプリケーションの構造化に適している理由" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">パイプラインがアプリケーションの構造化に適している理由</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#pipe" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">pipe</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#関数-vs-メソッド" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">関数 vs メソッド</span> </a> <ul class="isMobile astro-wbc2ynvf" style="--depth: 1;"> <li class="astro-wbc2ynvf" style="--depth: 1;"> <a href="#ツリーシェイキング" class="astro-wbc2ynvf" style="--depth: 1;"> <span class="astro-wbc2ynvf" style="--depth: 1;">ツリーシェイキング</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 1;"> <a href="#拡張性" class="astro-wbc2ynvf" style="--depth: 1;"> <span class="astro-wbc2ynvf" style="--depth: 1;">拡張性</span> </a>  </li> </ul>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#map" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">map</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#as" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">as</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#flatmap" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">flatMap</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#andthen" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">andThen</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#tap" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">tap</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#all" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">all</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#最初のパイプラインを構築する" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">最初のパイプラインを構築する</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#pipe-メソッド" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">pipe メソッド</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#チートシート" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">チートシート</span> </a>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-mgyjzhcd"><div class="sl-container astro-mgyjzhcd"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-wbc2ynvf" style="--depth: 0;"> <li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#_top" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#パイプラインがアプリケーションの構造化に適している理由" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">パイプラインがアプリケーションの構造化に適している理由</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#pipe" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">pipe</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#関数-vs-メソッド" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">関数 vs メソッド</span> </a> <ul class="astro-wbc2ynvf" style="--depth: 1;"> <li class="astro-wbc2ynvf" style="--depth: 1;"> <a href="#ツリーシェイキング" class="astro-wbc2ynvf" style="--depth: 1;"> <span class="astro-wbc2ynvf" style="--depth: 1;">ツリーシェイキング</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 1;"> <a href="#拡張性" class="astro-wbc2ynvf" style="--depth: 1;"> <span class="astro-wbc2ynvf" style="--depth: 1;">拡張性</span> </a>  </li> </ul>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#map" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">map</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#as" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">as</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#flatmap" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">flatMap</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#andthen" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">andThen</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#tap" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">tap</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#all" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">all</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#最初のパイプラインを構築する" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">最初のパイプラインを構築する</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#pipe-メソッド" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">pipe メソッド</span> </a>  </li><li class="astro-wbc2ynvf" style="--depth: 0;"> <a href="#チートシート" class="astro-wbc2ynvf" style="--depth: 0;"> <span class="astro-wbc2ynvf" style="--depth: 0;">チートシート</span> </a>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-iia7liwg">  <main data-pagefind-body lang="en" dir="ltr" class="astro-ds2wt7hw">    <div class="content-panel astro-qq65ezpp"> <div class="sl-container astro-qq65ezpp"> <h1 id="_top" class="astro-hbp5tgjk">パイプラインの構築</h1>  </div> </div>  <div class="content-panel astro-qq65ezpp"> <div class="sl-container astro-qq65ezpp"> <div class="sl-markdown-content"> <p>Effect パイプラインは、値に対する操作の構成やシーケンスを可能にし、データの変換と操作を簡潔かつモジュール化された形で実現します。</p>
<h2 id="パイプラインがアプリケーションの構造化に適している理由">パイプラインがアプリケーションの構造化に適している理由</h2>
<p>パイプラインは、アプリケーションを構造化し、データ変換を簡潔かつモジュール化された形で処理するための優れた方法です。以下のような多くの利点を提供します。</p>
<ol>
<li>
<p><strong>可読性</strong>: パイプラインを使用すると、関数を読みやすく、直列に構成することができます。データの流れや適用される操作が明確に見えるため、コードの理解と保守が容易になります。</p>
</li>
<li>
<p><strong>コードの整理</strong>: パイプラインを使用すると、複雑な操作を小さく管理可能な関数に分解することができます。各関数は特定のタスクを実行し、コードはよりモジュール化され、推論しやすくなります。</p>
</li>
<li>
<p><strong>再利用性</strong>: パイプラインは関数の再利用を促進します。操作を小さな関数に分解することで、異なるパイプラインやコンテキストで再利用でき、コードの再利用性が向上し、重複を減らします。</p>
</li>
<li>
<p><strong>型の安全性</strong>: タイプシステムを活用することで、パイプラインはコンパイル時にエラーを捕捉します。パイプライン内の関数は明確に定義された入力および出力の型を持ち、データが正しく流れることを保証し、ランタイムエラーを最小限に抑えます。</p>
</li>
</ol>
<p>次に、パイプラインを定義し、いくつかの重要な要素を探っていきましょう。</p>
<h2 id="pipe">pipe</h2>
<p><code dir="auto">pipe</code>関数は、関数を読みやすく直列に構成するためのユーティリティです。一つの関数の出力を次の関数への入力として渡します。これにより、複数の関数を連鎖して複雑な変換を構築できます。</p>
<p><code dir="auto">pipe</code>の基本的な構文は次のとおりです。</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.j8ofn.css"><script type="module" src="/_astro/ec.8zarh.js"></script><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">result</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(input</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">func1</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">func2</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#7FDBCA;--1:#097174">...</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">funcN)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe } from &#x22;effect&#x22;const result = pipe(input, func1, func2, ..., funcN)"><div></div></button></div></figure></div>
<p>この構文では、<code dir="auto">input</code>は初期値であり、<code dir="auto">func1</code>、<code dir="auto">func2</code>、…、<code dir="auto">funcN</code>は順次適用される関数です。各関数の結果が次の関数の入力となり、最終的な結果が返されます。</p>
<p>以下に<code dir="auto">pipe</code>の動作を示す例を示します。</p>
<p><img src="/images/mmd/pipeline.svg" alt="Pipe"></p>
<p><code dir="auto">pipe</code>に渡される関数は<strong>単一の引数</strong>を持つ必要があることに注意してください。これは、単一の引数でのみ呼び出されるためです。</p>
<p><code dir="auto">pipe</code>の動作をより良く理解するために、以下に例を見てみましょう。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// シンプルな算術演算を定義</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">increment</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">x</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">x</span><span style="--0:#C792EA;--1:#8D46B4"> + </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">double</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">x</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">x</span><span style="--0:#C792EA;--1:#8D46B4"> * </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">subtractTen</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">x</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">x</span><span style="--0:#C792EA;--1:#8D46B4"> - </span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// `pipe`を使ってこれらの操作を順次適用</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">result</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">increment</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">double</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">subtractTen);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53">(result); </span><span style="--0:#809191;--1:#5E6578">// 出力: 2</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe } from &#x22;effect&#x22;;// シンプルな算術演算を定義const increment = (x: number) => x + 1;const double = (x: number) => x * 2;const subtractTen = (x: number) => x - 10;// &#x60;pipe&#x60;を使ってこれらの操作を順次適用const result = pipe(5, increment, double, subtractTen);console.log(result); // 出力: 2"><div></div></button></div></figure></div>
<p>上記の例では、初期値として<code dir="auto">5</code>を使っています。<code dir="auto">increment</code>関数が初期値に<code dir="auto">1</code>を加え、結果として<code dir="auto">6</code>になります。次に<code dir="auto">double</code>関数がその値を倍にして<code dir="auto">12</code>となり、最後に<code dir="auto">subtractTen</code>関数が<code dir="auto">12</code>から<code dir="auto">10</code>を引いて最終出力<code dir="auto">2</code>になります。</p>
<p>この結果は<code dir="auto">subtractTen(double(increment(5)))</code>と同じですが、<code dir="auto">pipe</code>を使用すると、操作が左から右への順番で配列されているため、コードの可読性が向上します。入れ子構造にするのではなく、直列に構成されているからです。</p>
<h2 id="関数-vs-メソッド">関数 vs メソッド</h2>
<p>Effect エコシステムでは、ライブラリはしばしばメソッドよりも関数を公開しています。この設計選択には、ツリーシェイキングと拡張性の 2 つの重要な理由があります。</p>
<h3 id="ツリーシェイキング">ツリーシェイキング</h3>
<p>ツリーシェイキングとは、ビルドシステムがバンドルプロセス中に未使用のコードを除去する能力を指します。関数はツリーシェイキング可能であり、メソッドはそうではありません。</p>
<p>Effect エコシステムで関数が使用されると、実際にアプリケーションでインポートされて使用されている関数のみが最終的なバンドルコードに含まれます。未使用の関数は自動的に削除され、バンドルサイズが小さくなり、性能が向上します。</p>
<p>一方、メソッドはオブジェクトやプロトタイプに関連付けられ、簡単にツリーシェイキングができません。サブセットのメソッドのみを使用しても、オブジェクトやプロトタイプに関連付けられたすべてのメソッドがバンドルに含まれ、不必要なコードの肥大化を招きます。</p>
<h3 id="拡張性">拡張性</h3>
<p>Effect エコシステムで関数を使用するもう一つの重要な利点は、拡張性の容易さです。メソッドの機能を拡張するには、通常オブジェクトのプロトタイプを変更する必要があり、これは複雑でエラーを引き起こす可能性があります。</p>
<p>それに対し、関数を使用すれば、機能を拡張するのがはるかに簡単です。自分の”拡張メソッド”を単なる関数として定義でき、オブジェクトのプロトタイプを変更する必要がありません。これにより、よりクリーンでモジュール化されたコードが促進され、他のライブラリやモジュールとの互換性が向上します。</p>
<aside aria-label="Tip" class="starlight-aside starlight-aside--tip"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2l0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4l0 0c19.8 27.1 39.7 54.4 49.2 86.2H272zM192 512c44.2 0 80-35.8 80-80V416H112v16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"></path><path d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2l0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4l0 0c19.8 27.1 39.7 54.4 49.2 86.2H272zM192 512c44.2 0 80-35.8 80-80V416H112v16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"></path></svg>Tip</p><section class="starlight-aside__content"><p>Effect エコシステムのライブラリにおける関数の使用は、<strong>ツリーシェイキング</strong>を達成し、<strong>拡張性</strong>を確保するために重要です。関数は未使用のコードを排除することで効率的なバンドリングを可能にし、ライブラリの機能拡張に柔軟でモジュール化されたアプローチを提供します。</p></section></aside>
<p>次に、パイプラインを構築するために<code dir="auto">pipe</code>関数と組み合わせて使用できる API の例をいくつか見てみましょう。</p>
<h2 id="map">map</h2>
<p><code dir="auto">Effect.map</code>関数は、<code dir="auto">Effect</code>内の値を変換するために使用されます。関数を受け取り、それを<code dir="auto">Effect</code>内に含まれる値に適用して、変換された値を持つ<strong>新しい</strong><code dir="auto">Effect</code>を作成します。</p>
<p><strong>Effect.map の使用法</strong></p>
<p><code dir="auto">Effect.map</code>の構文は次のとおりです。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">mappedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(myEffect</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(transformation));</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// または</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">mappedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(myEffect</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">transformation);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// または</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">mappedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">myEffect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(transformation));</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect } from &#x22;effect&#x22;;const mappedEffect = pipe(myEffect, Effect.map(transformation));// またはconst mappedEffect = Effect.map(myEffect, transformation);// またはconst mappedEffect = myEffect.pipe(Effect.map(transformation));"><div></div></button></div></figure></div>
<p>上記のコードでは、<code dir="auto">transformation</code>は値に適用される関数であり、<code dir="auto">myEffect</code>は変換される<code dir="auto">Effect</code>です。</p>
<div><p><code dir="auto">Effect</code>は不変であることに注意が必要です。つまり、<code dir="auto">Effect.map</code>を使用して<code dir="auto">Effect</code>に適用しても、元のデータ型は変更されません。代わりに、変換された値を持つ<code dir="auto">Effect</code>の新しいコピーが返されます。</p></div>
<p><strong>例</strong></p>
<p>少額の手数料を取引に加算するプログラムを考えてみましょう：</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 取引金額に少額の手数料を加算する関数</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">addServiceCharge</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">amount</span><span style="--0:#C792EA;--1:#8D46B4"> + </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// データベースから取引金額を取得する非同期タスクのシミュレーション</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 取引金額に手数料を適用</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">finalAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(addServiceCharge));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">runPromise</span><span style="--0:#D6DEEB;--1:#403F53">(finalAmount)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">log</span><span style="--0:#D6DEEB;--1:#403F53">); </span><span style="--0:#809191;--1:#5E6578">// 出力: 101</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect } from &#x22;effect&#x22;;// 取引金額に少額の手数料を加算する関数const addServiceCharge = (amount: number) => amount + 1;// データベースから取引金額を取得する非同期タスクのシミュレーションconst fetchTransactionAmount = Effect.promise(() => Promise.resolve(100));// 取引金額に手数料を適用const finalAmount = pipe(fetchTransactionAmount, Effect.map(addServiceCharge));Effect.runPromise(finalAmount).then(console.log); // 出力: 101"><div></div></button></div></figure></div>
<h2 id="as">as</h2>
<p><code dir="auto">Effect</code>を定数値にマップし、元の値を置き換えるには、<code dir="auto">Effect.as</code>を使用します。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">succeed</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">as</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">新しい値</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">runPromise</span><span style="--0:#D6DEEB;--1:#403F53">(program)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">log</span><span style="--0:#D6DEEB;--1:#403F53">); </span><span style="--0:#809191;--1:#5E6578">// 出力: "新しい値"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect } from &#x22;effect&#x22;;const program = pipe(Effect.succeed(5), Effect.as(&#x22;新しい値&#x22;));Effect.runPromise(program).then(console.log); // 出力: &#x22;新しい値&#x22;"><div></div></button></div></figure></div>
<h2 id="flatmap">flatMap</h2>
<p><code dir="auto">Effect.flatMap</code>関数は、<code dir="auto">Effect</code>インスタンスを生成する変換を連鎖させる必要がある場合に使用されます。これは、非同期操作や前の<code dir="auto">Effect</code>の結果に依存する計算に便利です。</p>
<p><strong>Effect.flatMap の使用法</strong></p>
<p><code dir="auto">Effect.flatMap</code>関数を使用すると、新しい<code dir="auto">Effect</code>値を生成する計算をシーケンスさせ、ネストされた<code dir="auto">Effect</code>構造を”フラット化”できます。</p>
<p><code dir="auto">Effect.flatMap</code>の構文は次のとおりです。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">flatMappedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(myEffect</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(transformation));</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// または</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">flatMappedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(myEffect</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">transformation);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// または</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">flatMappedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">myEffect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(transformation));</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect } from &#x22;effect&#x22;;const flatMappedEffect = pipe(myEffect, Effect.flatMap(transformation));// またはconst flatMappedEffect = Effect.flatMap(myEffect, transformation);// またはconst flatMappedEffect = myEffect.pipe(Effect.flatMap(transformation));"><div></div></button></div></figure></div>
<p>上記のコードでは、<code dir="auto">transformation</code>は値を受け取って<code dir="auto">Effect</code>を返す関数であり、<code dir="auto">myEffect</code>は変換される最初の<code dir="auto">Effect</code>です。</p>
<div><p><code dir="auto">Effect</code>は不変であることに注意が必要です。つまり、<code dir="auto">Effect.flatMap</code>を使用して<code dir="auto">Effect</code>に適用しても、元のデータ型は変更されません。代わりに、変換された値を持つ<code dir="auto">Effect</code>の新しいコピーが返されます。</p></div>
<p><strong>例</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 取引金額に安全に割引を適用する関数</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">total</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">discountRate</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> Effect.</span><span style="--0:#FFCB8B;--1:#111111">Effect</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#FFCB8B;--1:#111111">Error</span><span style="--0:#C792EA;--1:#8D46B4">> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">discountRate</span><span style="--0:#C792EA;--1:#8D46B4"> === </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">?</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fail</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#097174">new</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Error</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">割引率はゼロにできません</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">succeed</span><span style="--0:#D6DEEB;--1:#403F53">(total </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> (total </span><span style="--0:#C792EA;--1:#8D46B4">*</span><span style="--0:#D6DEEB;--1:#403F53"> discountRate) </span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// データベースから取引金額を取得する非同期タスクのシミュレーション</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">finalAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#D6DEEB;--1:#403F53">(amount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">runPromise</span><span style="--0:#D6DEEB;--1:#403F53">(finalAmount)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">log</span><span style="--0:#D6DEEB;--1:#403F53">); </span><span style="--0:#809191;--1:#5E6578">// 出力: 95</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect } from &#x22;effect&#x22;;// 取引金額に安全に割引を適用する関数const applyDiscount = (  total: number,  discountRate: number): Effect.Effect<number, Error> =>  discountRate === 0    ? Effect.fail(new Error(&#x22;割引率はゼロにできません&#x22;))    : Effect.succeed(total - (total * discountRate) / 100);// データベースから取引金額を取得する非同期タスクのシミュレーションconst fetchTransactionAmount = Effect.promise(() => Promise.resolve(100));const finalAmount = pipe(  fetchTransactionAmount,  Effect.flatMap((amount) => applyDiscount(amount, 5)));Effect.runPromise(finalAmount).then(console.log); // 出力: 95"><div></div></button></div></figure></div>
<p><strong>すべての Effect が考慮されることの確認</strong></p>
<p><code dir="auto">Effect.flatMap</code>内のすべての Effect が最終的な計算に寄与することを確認することが重要です。Effect を無視すると、予期しない動作や誤った結果につながる可能性があります：</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line highlight mark"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#82AAFF;--1:#335497">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#773b98">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">sync</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=></span><span style="--0:#D6DEEB;--1:#403F53"> console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3C63B3">割引を適用する: </span><span style="--0:#DD6B68;--1:#B73936">${</span><span style="--0:#D6DEEB;--1:#403F53">amount</span><span style="--0:#DD6B68;--1:#B73936">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">)); </span><span style="--0:#809191;--1:#5E6578">// このEffectは無視されます</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8D46B4">return</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#D6DEEB;--1:#403F53">(amount, </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="Effect.flatMap((amount) => {  Effect.sync(() => console.log(&#x60;割引を適用する: ${amount}&#x60;)); // このEffectは無視されます  return applyDiscount(amount, 5);});"><div></div></button></div></figure></div>
<p>上記の<code dir="auto">Effect.sync</code>は無視され、<code dir="auto">applyDiscount(amount, 5)</code>の結果には影響を与えません。Effect を正しく含めてエラーを避けるためには、<code dir="auto">Effect.map</code>、<code dir="auto">Effect.flatMap</code>、<code dir="auto">Effect.andThen</code>、または<code dir="auto">Effect.tap</code>などの関数を使って明示的にチェーンする必要があります。</p>
<p><strong><code dir="auto">flatMap</code>に関するさらなる情報</strong></p>
<p>多くの開発者が<code dir="auto">flatMap</code>を配列と共に使用することを認識しているかもしれませんが、<code dir="auto">Effect</code>フレームワークではネストされた<code dir="auto">Effect</code>構造を管理し、解決するために使用されます。
もし目標が Effect 内のネストされた配列をフラット化すること（<code dir="auto">Effect&#x3C;Array&#x3C;Array&#x3C;A>>></code>）であれば、次のようにできます。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect, Array } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">flattened</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">succeed</span><span style="--0:#D6DEEB;--1:#403F53">([</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">[</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">],</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">[</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">],</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">])</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">nested</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">Array</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatten</span><span style="--0:#D6DEEB;--1:#403F53">(nested))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect, Array } from &#x22;effect&#x22;;const flattened = pipe(  Effect.succeed([    [1, 2],    [3, 4],  ]),  Effect.map((nested) => Array.flatten(nested)));"><div></div></button></div></figure></div>
<p>または、標準の<code dir="auto">Array.prototype.flat()</code>メソッドを使用して行うこともできます。</p>
<h2 id="andthen">andThen</h2>
<p><code dir="auto">Effect.map</code>および<code dir="auto">Effect.flatMap</code>関数は、異なるシナリオで<code dir="auto">Effect</code>を別の<code dir="auto">Effect</code>に変換します。最初のシナリオでは、変換関数が<code dir="auto">Effect</code>を返さない場合に<code dir="auto">Effect.map</code>が使用され、2 番目のシナリオでは、変換関数がまだ<code dir="auto">Effect</code>を返す場合に<code dir="auto">Effect.flatMap</code>が使用されます。しかし、両方のシナリオが変換を含むため、Effect モジュールは便利なオールインワンソリューションである<code dir="auto">Effect.andThen</code>を公開しています。</p>
<p><code dir="auto">Effect.andThen</code>関数は、通常 2 つの<code dir="auto">Effect</code>のアクションを実行します。2 番目のアクションは、最初のアクションの結果に依存することがあります。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">transformedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(myEffect</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">andThen</span><span style="--0:#D6DEEB;--1:#403F53">(anotherEffect));</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// または</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">transformedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">andThen</span><span style="--0:#D6DEEB;--1:#403F53">(myEffect</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">anotherEffect);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// または</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">transformedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">myEffect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">andThen</span><span style="--0:#D6DEEB;--1:#403F53">(anotherEffect));</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect } from &#x22;effect&#x22;;const transformedEffect = pipe(myEffect, Effect.andThen(anotherEffect));// またはconst transformedEffect = Effect.andThen(myEffect, anotherEffect);// またはconst transformedEffect = myEffect.pipe(Effect.andThen(anotherEffect));"><div></div></button></div></figure></div>
<p><code dir="auto">anotherEffect</code>アクションはさまざまな形を取り得ます：</p>
<ol>
<li>値（すなわち、<code dir="auto">Effect.as</code>の同じ機能）</li>
<li>値を返す関数（すなわち、<code dir="auto">Effect.map</code>の同じ機能）</li>
<li><code dir="auto">Promise</code></li>
<li><code dir="auto">Promise</code>を返す関数</li>
<li><code dir="auto">Effect</code></li>
<li><code dir="auto">Effect</code>を返す関数（すなわち、<code dir="auto">Effect.flatMap</code>の同じ機能）</li>
</ol>
<p><strong>例</strong></p>
<p><code dir="auto">Effect.andThen</code>を使用する代わりに<code dir="auto">Effect.map</code>と<code dir="auto">Effect.flatMap</code>を比較する例を見てみましょう。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 取引金額に安全に割引を適用する関数</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">total</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">discountRate</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> Effect.</span><span style="--0:#FFCB8B;--1:#111111">Effect</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#FFCB8B;--1:#111111">Error</span><span style="--0:#C792EA;--1:#8D46B4">> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">discountRate</span><span style="--0:#C792EA;--1:#8D46B4"> === </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">?</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fail</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#097174">new</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Error</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">割引率はゼロにできません</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">succeed</span><span style="--0:#D6DEEB;--1:#403F53">(total </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> (total </span><span style="--0:#C792EA;--1:#8D46B4">*</span><span style="--0:#D6DEEB;--1:#403F53"> discountRate) </span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// データベースから取引金額を取得する非同期タスクのシミュレーション</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// Effect.mapとEffect.flatMapを使用</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">result1</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">amount</span><span style="--0:#C792EA;--1:#8D46B4"> * </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#D6DEEB;--1:#403F53">(amount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">runPromise</span><span style="--0:#D6DEEB;--1:#403F53">(result1)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">log</span><span style="--0:#D6DEEB;--1:#403F53">); </span><span style="--0:#809191;--1:#5E6578">// 出力: 190</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// Effect.andThenを使用</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">result2</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">andThen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">amount</span><span style="--0:#C792EA;--1:#8D46B4"> * </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">andThen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#D6DEEB;--1:#403F53">(amount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">runPromise</span><span style="--0:#D6DEEB;--1:#403F53">(result2)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">log</span><span style="--0:#D6DEEB;--1:#403F53">); </span><span style="--0:#809191;--1:#5E6578">// 出力: 190</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect } from &#x22;effect&#x22;;// 取引金額に安全に割引を適用する関数const applyDiscount = (  total: number,  discountRate: number): Effect.Effect<number, Error> =>  discountRate === 0    ? Effect.fail(new Error(&#x22;割引率はゼロにできません&#x22;))    : Effect.succeed(total - (total * discountRate) / 100);// データベースから取引金額を取得する非同期タスクのシミュレーションconst fetchTransactionAmount = Effect.promise(() => Promise.resolve(100));// Effect.mapとEffect.flatMapを使用const result1 = pipe(  fetchTransactionAmount,  Effect.map((amount) => amount * 2),  Effect.flatMap((amount) => applyDiscount(amount, 5)));Effect.runPromise(result1).then(console.log); // 出力: 190// Effect.andThenを使用const result2 = pipe(  fetchTransactionAmount,  Effect.andThen((amount) => amount * 2),  Effect.andThen((amount) => applyDiscount(amount, 5)));Effect.runPromise(result2).then(console.log); // 出力: 190"><div></div></button></div></figure></div>
<p><code dir="auto">Option</code>（選択値の処理に一般的に使用される型）や<code dir="auto">Either</code>（単純なエラーシナリオを処理するための型）が<code dir="auto">Effect.andThen</code>と互換性があることにも注意が必要です。ただし、これらの型が使用される場合、操作は前述のシナリオ 5 および 6 に分類され、<code dir="auto">Option</code>および<code dir="auto">Either</code>はこの文脈で<code dir="auto">Effect</code>として機能します。</p>
<p><strong>Option を使った例</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect, Option } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// データベースから数値を取得する非同期タスクのシミュレーション</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchNumberValue</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">42</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// タイプはEffect&#x3C;Option&#x3C;number>, never, never>であることが期待されますが、</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 実際にはEffect&#x3C;number, NoSuchElementException, never>です。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">fetchNumberValue</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">andThen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">x</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">(x</span><span style="--0:#C792EA;--1:#8D46B4"> > </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#C792EA;--1:#8D46B4"> ? </span><span style="--0:#D6DEEB;--1:#403F53">Option</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">some</span><span style="--0:#D6DEEB;--1:#403F53">(x)</span><span style="--0:#C792EA;--1:#8D46B4"> : </span><span style="--0:#D6DEEB;--1:#403F53">Option</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">none</span><span style="--0:#D6DEEB;--1:#403F53">()))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect, Option } from &#x22;effect&#x22;;// データベースから数値を取得する非同期タスクのシミュレーションconst fetchNumberValue = Effect.promise(() => Promise.resolve(42));// タイプはEffect<Option<number>, never, never>であることが期待されますが、// 実際にはEffect<number, NoSuchElementException, never>です。const program = pipe(  fetchNumberValue,  Effect.andThen((x) => (x > 0 ? Option.some(x) : Option.none())));"><div></div></button></div></figure></div>
<p>型<code dir="auto">Option&#x3C;A></code>は、<code dir="auto">Effect&#x3C;A, NoSuchElementException></code>という型の Effect として解釈されます。</p>
<p><strong>Either を使った例</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect, Either } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 文字列から整数を解析する関数（失敗する可能性あり）</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">parseInteger</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">input</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">string</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> Either.</span><span style="--0:#FFCB8B;--1:#111111">Either</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#C5E478;--1:#3C63B3">string</span><span style="--0:#C792EA;--1:#8D46B4">> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3C63B3">isNaN</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">parseInt</span><span style="--0:#D6DEEB;--1:#403F53">(input))</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">?</span><span style="--0:#D6DEEB;--1:#403F53"> Either</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">left</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">無効な整数</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Either</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">right</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">parseInt</span><span style="--0:#D6DEEB;--1:#403F53">(input));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// データベースから文字列を取得する非同期タスクのシミュレーション</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchStringValue</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">42</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// タイプはEffect&#x3C;Either&#x3C;number, string>, never, never>であることが期待されますが、</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 実際にはEffect&#x3C;number, string, never>です。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">fetchStringValue</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">andThen</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">str</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#82AAFF;--1:#3C63B3">parseInteger</span><span style="--0:#D6DEEB;--1:#403F53">(str))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect, Either } from &#x22;effect&#x22;;// 文字列から整数を解析する関数（失敗する可能性あり）const parseInteger = (input: string): Either.Either<number, string> =>  isNaN(parseInt(input))    ? Either.left(&#x22;無効な整数&#x22;)    : Either.right(parseInt(input));// データベースから文字列を取得する非同期タスクのシミュレーションconst fetchStringValue = Effect.promise(() => Promise.resolve(&#x22;42&#x22;));// タイプはEffect<Either<number, string>, never, never>であることが期待されますが、// 実際にはEffect<number, string, never>です。const program = pipe(  fetchStringValue,  Effect.andThen((str) => parseInteger(str)));"><div></div></button></div></figure></div>
<p>型<code dir="auto">Either&#x3C;A, E></code>は、<code dir="auto">Effect&#x3C;A, E></code>という型の Effect として解釈されます。</p>
<h2 id="tap">tap</h2>
<p><code dir="auto">Effect.tap</code> API は<code dir="auto">Effect.flatMap</code>と似た構文を持っていますが、変換関数の結果は<strong>無視</strong>されます。これは、前の計算から返された値が次の計算にも利用可能であることを意味します。</p>
<p><strong>例</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { pipe, Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 取引金額に安全に割引を適用する関数</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">total</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">discountRate</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> Effect.</span><span style="--0:#FFCB8B;--1:#111111">Effect</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#FFCB8B;--1:#111111">Error</span><span style="--0:#C792EA;--1:#8D46B4">> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">discountRate</span><span style="--0:#C792EA;--1:#8D46B4"> === </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">?</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fail</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#097174">new</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Error</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">割引率はゼロにできません</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">succeed</span><span style="--0:#D6DEEB;--1:#403F53">(total </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> (total </span><span style="--0:#C792EA;--1:#8D46B4">*</span><span style="--0:#D6DEEB;--1:#403F53"> discountRate) </span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// データベースから取引金額を取得する非同期タスクのシミュレーション</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">finalAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">tap</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">sync</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3C63B3">割引を適用する: </span><span style="--0:#DD6B68;--1:#B73936">${</span><span style="--0:#D6DEEB;--1:#403F53">amount</span><span style="--0:#DD6B68;--1:#B73936">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#809191;--1:#5E6578">// `amount`はまだ利用可能です！</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#D6DEEB;--1:#403F53">(amount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">runPromise</span><span style="--0:#D6DEEB;--1:#403F53">(finalAmount)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">log</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">/*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">出力:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">割引を適用する: 100</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">95</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">*/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { pipe, Effect } from &#x22;effect&#x22;;// 取引金額に安全に割引を適用する関数const applyDiscount = (  total: number,  discountRate: number): Effect.Effect<number, Error> =>  discountRate === 0    ? Effect.fail(new Error(&#x22;割引率はゼロにできません&#x22;))    : Effect.succeed(total - (total * discountRate) / 100);// データベースから取引金額を取得する非同期タスクのシミュレーションconst fetchTransactionAmount = Effect.promise(() => Promise.resolve(100));const finalAmount = pipe(  fetchTransactionAmount,  Effect.tap((amount) =>    Effect.sync(() => console.log(&#x60;割引を適用する: ${amount}&#x60;))  ),  // &#x60;amount&#x60;はまだ利用可能です！  Effect.flatMap((amount) => applyDiscount(amount, 5)));Effect.runPromise(finalAmount).then(console.log);/*出力:割引を適用する: 10095*/"><div></div></button></div></figure></div>
<p><code dir="auto">Effect.tap</code>を使用すると、計算中に副作用を実行できますが、結果を変更しません。これは、ログを記録したり、追加のアクションを実行したり、中間値を観察したりする際に便利です。</p>
<h2 id="all">all</h2>
<p><code dir="auto">Effect.all</code>関数は、複数の効果を組み合わせて、結果のタプルを生成する単一の効果を生成するための強力なユーティリティです。</p>
<p><strong>Effect.all の使用法</strong></p>
<p><code dir="auto">Effect.all</code>の構文は次のとおりです。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">combinedEffect</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">all</span><span style="--0:#D6DEEB;--1:#403F53">([effect1, effect2, </span><span style="--0:#7FDBCA;--1:#097174">...</span><span style="--0:#D6DEEB;--1:#403F53">])</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { Effect } from &#x22;effect&#x22;const combinedEffect = Effect.all([effect1, effect2, ...])"><div></div></button></div></figure></div>
<p><code dir="auto">Effect.all</code>関数は、これらの効果を<strong>順次</strong>実行します（同時実行の管理やこれらの効果の実行方法を制御するオプションについては、<a href="../concurrency/concurrency-options">同時実行オプション</a>ドキュメントを参照してください）。</p>
<p>この関数は、各個々の効果の結果を含むタプルを生成する新しい効果を返します。結果の順序は、<code dir="auto">Effect.all</code>に渡された元の効果の順序に対応しています。</p>
<p><strong>例</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 設定をファイルから読み取るシミュレーション関数</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">webConfig</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">{ dbConnection: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">localhost</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8D46B4">, port: </span><span style="--0:#F78C6C;--1:#AA0982">8080</span><span style="--0:#C792EA;--1:#8D46B4"> }</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// データベース接続の確認を行うシミュレーション関数</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">checkDatabaseConnectivity</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">データベースに接続しました</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// スタートアップチェックを実行するために両方の効果を組み合わせる</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">startupChecks</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">all</span><span style="--0:#D6DEEB;--1:#403F53">([webConfig, checkDatabaseConnectivity]);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">runPromise</span><span style="--0:#D6DEEB;--1:#403F53">(startupChecks)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--1:#403F53"><span style="--0:#D6DEEB">[</span><span style="--0:#D7DBE0">config</span><span style="--0:#D6DEEB">, </span><span style="--0:#D7DBE0">dbStatus</span><span style="--0:#D6DEEB">]</span></span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">log</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3C63B3">設定: </span><span style="--0:#DD6B68;--1:#B73936">${</span><span style="--0:#82AAFF;--1:#3C63B3">JSON</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(config)</span><span style="--0:#DD6B68;--1:#B73936">}</span><span style="--0:#ECC48D;--1:#3C63B3">, DBステータス: </span><span style="--0:#DD6B68;--1:#B73936">${</span><span style="--0:#D6DEEB;--1:#403F53">dbStatus</span><span style="--0:#DD6B68;--1:#B73936">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">/*</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">出力:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">設定: {"dbConnection":"localhost","port":8080}, DBステータス: データベースに接続しました</span></div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#616671">*/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { Effect } from &#x22;effect&#x22;;// 設定をファイルから読み取るシミュレーション関数const webConfig = Effect.promise(() =>  Promise.resolve({ dbConnection: &#x22;localhost&#x22;, port: 8080 }));// データベース接続の確認を行うシミュレーション関数const checkDatabaseConnectivity = Effect.promise(() =>  Promise.resolve(&#x22;データベースに接続しました&#x22;));// スタートアップチェックを実行するために両方の効果を組み合わせるconst startupChecks = Effect.all([webConfig, checkDatabaseConnectivity]);Effect.runPromise(startupChecks).then(([config, dbStatus]) => {  console.log(&#x60;設定: ${JSON.stringify(config)}, DBステータス: ${dbStatus}&#x60;);});/*出力:設定: {&#x22;dbConnection&#x22;:&#x22;localhost&#x22;,&#x22;port&#x22;:8080}, DBステータス: データベースに接続しました*/"><div></div></button></div></figure></div>
<div><p><code dir="auto">Effect.all</code>関数は、タプルを組み合わせるだけでなく、イテラブル、構造体、およびレコードとも動作します。<code dir="auto">all</code>の完全な可能性を探るには、<a href="../control-flow#all">Effect の制御フローオペレーターの紹介</a>ドキュメントにアクセスしてください。</p></div>
<h2 id="最初のパイプラインを構築する">最初のパイプラインを構築する</h2>
<p>次に、<code dir="auto">pipe</code>、<code dir="auto">Effect.all</code>、<code dir="auto">Effect.andThen</code>を組み合わせて、一連の変換を実行するパイプラインを構築しましょう。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect, pipe } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 取引金額に少額の手数料を加算する関数</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">addServiceCharge</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">amount</span><span style="--0:#C792EA;--1:#8D46B4"> + </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 取引金額に安全に割引を適用する関数</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">total</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">discountRate</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> Effect.</span><span style="--0:#FFCB8B;--1:#111111">Effect</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#FFCB8B;--1:#111111">Error</span><span style="--0:#C792EA;--1:#8D46B4">> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">discountRate</span><span style="--0:#C792EA;--1:#8D46B4"> === </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">?</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fail</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#097174">new</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Error</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">割引率はゼロにできません</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">succeed</span><span style="--0:#D6DEEB;--1:#403F53">(total </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> (total </span><span style="--0:#C792EA;--1:#8D46B4">*</span><span style="--0:#D6DEEB;--1:#403F53"> discountRate) </span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// データベースから取引金額を取得する非同期タスクのシミュレーション</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 設定ファイルから割引率を取得する非同期タスクのシミュレーション</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchDiscountRate</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// 効果のパイプラインを作成</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">all</span><span style="--0:#D6DEEB;--1:#403F53">([fetchTransactionAmount, fetchDiscountRate])</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#C792EA;--1:#8D46B4">[</span><span style="--0:#D7DBE0;--1:#403F53">transactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D7DBE0;--1:#403F53">discountRate</span><span style="--0:#C792EA;--1:#8D46B4">]</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#D6DEEB;--1:#403F53">(transactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">discountRate)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(addServiceCharge)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">finalAmount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3C63B3">請求額: </span><span style="--0:#DD6B68;--1:#B73936">${</span><span style="--0:#D6DEEB;--1:#403F53">finalAmount</span><span style="--0:#DD6B68;--1:#B73936">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// プログラムを実行して結果をログに記録</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">runPromise</span><span style="--0:#D6DEEB;--1:#403F53">(program)</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">then</span><span style="--0:#D6DEEB;--1:#403F53">(console</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">log</span><span style="--0:#D6DEEB;--1:#403F53">); </span><span style="--0:#809191;--1:#5E6578">// 出力: "請求額: 96"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { Effect, pipe } from &#x22;effect&#x22;;// 取引金額に少額の手数料を加算する関数const addServiceCharge = (amount: number) => amount + 1;// 取引金額に安全に割引を適用する関数const applyDiscount = (  total: number,  discountRate: number): Effect.Effect<number, Error> =>  discountRate === 0    ? Effect.fail(new Error(&#x22;割引率はゼロにできません&#x22;))    : Effect.succeed(total - (total * discountRate) / 100);// データベースから取引金額を取得する非同期タスクのシミュレーションconst fetchTransactionAmount = Effect.promise(() => Promise.resolve(100));// 設定ファイルから割引率を取得する非同期タスクのシミュレーションconst fetchDiscountRate = Effect.promise(() => Promise.resolve(5));// 効果のパイプラインを作成const program = pipe(  Effect.all([fetchTransactionAmount, fetchDiscountRate]),  Effect.flatMap(([transactionAmount, discountRate]) =>    applyDiscount(transactionAmount, discountRate)  ),  Effect.map(addServiceCharge),  Effect.map((finalAmount) => &#x60;請求額: ${finalAmount}&#x60;));// プログラムを実行して結果をログに記録Effect.runPromise(program).then(console.log); // 出力: &#x22;請求額: 96&#x22;"><div></div></button></div></figure></div>
<h2 id="pipe-メソッド">pipe メソッド</h2>
<p>Effect は、<a href="https://rxjs.dev/api/index/function/pipe">rxjs</a>の<code dir="auto">pipe</code>メソッドに似た<code dir="auto">pipe</code>メソッドも提供しています。このメソッドを使用すると、複数の操作を連鎖させることができ、コードが簡潔で読みやすくなります。</p>
<p><code dir="auto">pipe</code> <strong>メソッド</strong>の使い方は次のとおりです。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">result</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(func1</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">func2</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#7FDBCA;--1:#097174">...</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">funcN)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const result = effect.pipe(func1, func2, ..., funcN)"><div></div></button></div></figure></div>
<p>これは、次のように<code dir="auto">pipe</code> <strong>関数</strong>を使用するのと同等です。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">result</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(effect</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">func1</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">func2</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#7FDBCA;--1:#097174">...</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">funcN)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const result = pipe(effect, func1, func2, ..., funcN)"><div></div></button></div></figure></div>
<p><code dir="auto">pipe</code>メソッドはすべての<code dir="auto">Effect</code>および多くの他のデータ型で使用でき、<code dir="auto">Function</code>モジュールから<code dir="auto">pipe</code>関数をインポートする必要がなくなり、キーストロークを節約します。</p>
<p>前の例を<code dir="auto">pipe</code>メソッドを使って書き直してみましょう。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> { Effect } </span><span style="--0:#C792EA;--1:#8D46B4">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">effect</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">addServiceCharge</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">amount</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">amount</span><span style="--0:#C792EA;--1:#8D46B4"> + </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">total</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D7DBE0;--1:#403F53">discountRate</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">number</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#7FDBCA;--1:#097174">:</span><span style="--0:#C792EA;--1:#8D46B4"> Effect.</span><span style="--0:#FFCB8B;--1:#111111">Effect</span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#C5E478;--1:#3C63B3">number</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#FFCB8B;--1:#111111">Error</span><span style="--0:#C792EA;--1:#8D46B4">> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">discountRate</span><span style="--0:#C792EA;--1:#8D46B4"> === </span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">?</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">fail</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#097174">new</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">Error</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">割引率はゼロにできません</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">succeed</span><span style="--0:#D6DEEB;--1:#403F53">(total </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> (total </span><span style="--0:#C792EA;--1:#8D46B4">*</span><span style="--0:#D6DEEB;--1:#403F53"> discountRate) </span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchTransactionAmount</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">100</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchDiscountRate</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">promise</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#C5E478;--1:#3C63B3">Promise</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">resolve</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">));</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#809191;--1:#5E6578">// ---cut---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">program</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">all</span><span style="--0:#D6DEEB;--1:#403F53">([fetchTransactionAmount, fetchDiscountRate])</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">pipe</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">flatMap</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#C792EA;--1:#8D46B4">[</span><span style="--0:#D7DBE0;--1:#403F53">transactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D7DBE0;--1:#403F53">discountRate</span><span style="--0:#C792EA;--1:#8D46B4">]</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> =></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3C63B3">applyDiscount</span><span style="--0:#D6DEEB;--1:#403F53">(transactionAmount</span><span style="--0:#C792EA;--1:#8D46B4">, </span><span style="--0:#D6DEEB;--1:#403F53">discountRate)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(addServiceCharge)</span><span style="--0:#C792EA;--1:#8D46B4">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D6DEEB;--1:#403F53">Effect</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">map</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">finalAmount</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> => </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3C63B3">請求額: </span><span style="--0:#DD6B68;--1:#B73936">${</span><span style="--0:#D6DEEB;--1:#403F53">finalAmount</span><span style="--0:#DD6B68;--1:#B73936">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { Effect } from &#x22;effect&#x22;;const addServiceCharge = (amount: number) => amount + 1;const applyDiscount = (  total: number,  discountRate: number): Effect.Effect<number, Error> =>  discountRate === 0    ? Effect.fail(new Error(&#x22;割引率はゼロにできません&#x22;))    : Effect.succeed(total - (total * discountRate) / 100);const fetchTransactionAmount = Effect.promise(() => Promise.resolve(100));const fetchDiscountRate = Effect.promise(() => Promise.resolve(5));// ---cut---const program = Effect.all([fetchTransactionAmount, fetchDiscountRate]).pipe(  Effect.flatMap(([transactionAmount, discountRate]) =>    applyDiscount(transactionAmount, discountRate)  ),  Effect.map(addServiceCharge),  Effect.map((finalAmount) => &#x60;請求額: ${finalAmount}&#x60;));"><div></div></button></div></figure></div>
<h2 id="チートシート">チートシート</h2>
<p>これまで見てきた変換関数をまとめましょう：</p>



































<table><thead><tr><th><strong>関数</strong></th><th><strong>入力</strong></th><th><strong>出力</strong></th></tr></thead><tbody><tr><td><code dir="auto">map</code></td><td><code dir="auto">Effect&#x3C;A, E, R></code>, <code dir="auto">A => B</code></td><td><code dir="auto">Effect&#x3C;B, E, R></code></td></tr><tr><td><code dir="auto">flatMap</code></td><td><code dir="auto">Effect&#x3C;A, E, R></code>, <code dir="auto">A => Effect&#x3C;B, E, R></code></td><td><code dir="auto">Effect&#x3C;B, E, R></code></td></tr><tr><td><code dir="auto">andThen</code></td><td><code dir="auto">Effect&#x3C;A, E, R></code>, *</td><td><code dir="auto">Effect&#x3C;B, E, R></code></td></tr><tr><td><code dir="auto">tap</code></td><td><code dir="auto">Effect&#x3C;A, E, R></code>, <code dir="auto">A => Effect&#x3C;B, E, R></code></td><td><code dir="auto">Effect&#x3C;A, E, R></code></td></tr><tr><td><code dir="auto">all</code></td><td><code dir="auto">[Effect&#x3C;A, E, R>, Effect&#x3C;B, E, R>, ...]</code></td><td><code dir="auto">Effect&#x3C;[A, B, ...], E, R></code></td></tr></tbody></table>
<p>これらの関数は、<code dir="auto">Effect</code>計算を変換し、連鎖させるための強力なツールです。これらを使用することで、<code dir="auto">Effect</code>内の値に関数を適用し、複雑な計算のパイプラインを構築できます。</p> </div> <footer class="sl-flex astro-gcr56zec"> <div class="meta sl-flex astro-gcr56zec">   </div> <div class="pagination-links astro-qepcwt4y" dir="ltr"> <a href="/guides/effect-essentials/500-using-generators_ja/" rel="prev" class="astro-qepcwt4y"> <svg aria-hidden="true" class="astro-qepcwt4y astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-qepcwt4y"> Previous <br class="astro-qepcwt4y"> <span class="link-title astro-qepcwt4y">Effectにおけるジェネレーターの使用</span> </span> </a> <a href="/guides/error-management/" rel="next" class="astro-qepcwt4y"> <svg aria-hidden="true" class="astro-qepcwt4y astro-mzbodlcp" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-qepcwt4y"> Next <br class="astro-qepcwt4y"> <span class="link-title astro-qepcwt4y">Error Management</span> </span> </a> </div>   </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>